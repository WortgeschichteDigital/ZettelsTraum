let j={dimensions:{width:720,height:500,lineMax:710,groupHeights:[51,55,59]},calculateTimespan(){var e,t=[...document.querySelectorAll("#wgd-belegauswahl > div")];let a=0;for(e of Object.values(s.data.lemmas))for(var r of e.meanings)for(var n of r.quotations){n=this.getYear(n);n&&(!a||n<a)&&(a=n)}a=a||this.getYear(t[0].id);let i=this.getYear(t.at(-1)?.id||t.at(-1));t=(new Date).getFullYear();return t-i<10&&(i=t<i+10?t:i+10),{first:a=i-a<10?i-10:a,last:i,pxYear:(this.dimensions.width-90)/(i-a)}},createElement(e,t={}){var a,r,n=document.createElementNS("http://www.w3.org/2000/svg",e);for([a,r]of Object.entries(t))n.setAttribute(a,r);return n},createGradient({svg:e,x1:t,x2:a,fadeIn:r,cl:n=""}){var i=e.querySelector("defs"),s="bedvisGradOut"+i.querySelectorAll("linearGradient").length,l={id:s,x1:t,x2:a,gradientUnits:"userSpaceOnUse"},d=(n&&(l.class=n),this.createElement("linearGradient",l));for(let h=1;h<=2;h++){var o=r?h-1:h%2;d.appendChild(this.createElement("stop",{offset:h-1,"stop-opacity":o}))}return i.appendChild(d),s},pointerEvent(e){e.setAttribute("pointer-events","auto");var t=this.createElement("title");e.appendChild(t)},getYear(e){var t;return"number"==typeof e?e:(t=document.querySelector(`#${e} time`))&&(t=t.getAttribute("datetime").match(/^[0-9]{4}/)?.[0])?parseInt(t,10):0}},s={data:{},validateData(){for(var e of Object.values(this.data.lemmas)){for(var t of e.events)t.yearFrom>t.yearTo?t.yearTo=t.yearFrom:!t.yearFrom&&t.yearTo?t.yearFrom=t.yearTo:t.yearFrom&&!t.yearTo&&(t.yearTo=t.yearFrom);for(var a of e.meanings)a.frequency<1?a.frequency=1:3<a.frequency&&(a.frequency=3)}},svg(e){var t=Object.keys(this.data.lemmas);let a;var r={"aria-labelledby":"bedvis-title-"+(a=(a=this.data.lemmaList?this.data.lemmas.lemmas.meanings.flatMap(e=>e.definition):t).join(" ").replace(/ /g,"_").toLowerCase()),width:j.dimensions.width,height:j.dimensions.height,"pointer-events":"none",viewBox:`0 0 ${j.dimensions.width} `+j.dimensions.height,class:"bedvis"},r=(this.data.description&&(r["aria-describedby"]="bedvis-desc-"+a),this.data.lemmaList&&(r.class="bedvis lemma-list"),j.createElement("svg",r)),n=j.createElement("title",{id:"bedvis-title-"+a}),t=(r.appendChild(n),t.join("“, „").replace(/^(.+)(, )/,(...e)=>e[1]+" und ")),t=(n.textContent=`Bedeutungsentwicklung von „${t}“`,this.data.description&&(n=j.createElement("desc",{id:"bedvis-desc-"+a}),r.appendChild(n),n.textContent=this.data.description),this.defs(r),j.calculateTimespan()),n=this.meanings(r,t,e),i=this.timeline(r,t,n),t=n+26+22*this.events({svg:r,timespan:t,top:n,timelineData:i});return r.setAttribute("height",t),r.setAttribute("viewBox",`0 0 ${j.dimensions.width} `+t),r},defs(e){var t,a=j.createElement("defs");e.appendChild(a),a.appendChild(j.createElement("path",{id:"bedvisArrow",d:"M 0 0 L 10 5 L 0 10 C 5 2, 5 8, 0 0"}));for(t of["Grey","Blue","BlueHover"]){var r=j.createElement("marker",{id:"bedvisArrow"+t,viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"16",markerHeight:"16",markerUnits:"userSpaceOnUse",class:"arrow-"+t.toLowerCase()});r.appendChild(j.createElement("use",{href:"#bedvisArrow"})),a.appendChild(r)}},meanings(n,i,s){var l=this.data.lemmaList;let d={};l&&(document.querySelector(".wgd-kopf-hl")?.textContent?.split(/\s·\s/)?.forEach(e=>{d[e]=""}),document.querySelectorAll(".wgd-kopf-nl a").forEach(e=>{d[e.textContent]=e.getAttribute("href")}),document.querySelectorAll("#wgd-wortinformationen > div > p > a").forEach(e=>{var t=e.getAttribute("href");/^#/.test(t)&&(d[e.textContent]=t)}));var o,h,a,O=Object.keys(this.data.lemmas).length;let m=0;for([o,h]of Object.entries(this.data.lemmas)){1<O?(m+=16,(a=j.createElement("text",{x:j.dimensions.width/2,y:m,"dominant-baseline":"hanging","text-anchor":"middle",class:"lemma"})).textContent=o,n.appendChild(a),m+=40):m+=8;for(let e=0,t=h.meanings.length;e<t;e++){var c=h.meanings[e],p=document.getElementById(c.id);if(p||l){var r,u=[];for(r of c.quotations){var f=j.getYear(r);f&&u.push({id:r,year:f,yearText:"number"==typeof r?""+r:document.querySelector(`#${r} time`).textContent.replace(/[a-z]$/,"")})}if(u.length){e&&s.standalone&&(m+=15);var g=j.createElement("g"),v=(n.appendChild(g),j.pointerEvent(g),j.dimensions.groupHeights[c.frequency-1]),y=5+[0,2,4][c.frequency-1],x=50+Math.round((u[0].year-i.first)*i.pxYear);let r=j.dimensions.lineMax;c.usedUntil&&1<u.length&&(r=50+Math.round((u.at(-1).year-i.first)*i.pxYear));var b=[1,3,5][c.frequency-1],w=m+20+y,C=(g.appendChild(j.createElement("rect",{x:x,y:m,width:r-x,height:v,class:"blind"})),j.createElement("text",{x:x+y,y:m,"dominant-baseline":"hanging",class:"definition"})),E=c.definition||p?.querySelector("q")?.textContent||"[keine Angabe]";if(l)L(C,E,l);else{L(C,E,l);let e=p.querySelector(".wgd-zaehlz")?.textContent,t=p.parentNode.parentNode;for(;"LI"===t.nodeName;){var q=t.querySelector(".wgd-zaehlz")?.textContent;q&&(e=q+e),t=t.parentNode.parentNode}h.showNumbering&&e&&((k=j.createElement("tspan",{class:"bold","dominant-baseline":"hanging"})).textContent=e+" ".repeat(2),C.insertBefore(k,C.firstChild))}let a;if(l){let e=c.definition.replace(/_/g,"");var k=["¹","²","³","⁴","⁵","⁶","⁷","⁸","⁹"].indexOf(e.substring(0,1));let t=0;if(0<=k&&(e=e.substring(1),t=k+1),void 0!==d[e])a=d[e];else if(s.artData?.values)e:for(var S of s.artData.values.le){var Y,G=parseInt(S.match(/ \((\d+)\)$/)?.[1]||0,10);for(Y of(S=S.replace(/ \(.+?\)$/,"")).split("/"))if(Y===e&&G===t){1<t&&(e+="-"+t),a=window.location.origin+"/wb/wortgeschichten/"+encodeURIComponent(e);break e}}}else a=p.querySelector("a")?.getAttribute("href");a&&/^(#|http)/.test(a)?((p=j.createElement("a",{href:a,tabindex:-1,class:"definition"})).appendChild(C),g.appendChild(p)):g.appendChild(C);var A,$,F,p={x1:x,y1:w,x2:r,y2:w,"stroke-width":b,class:"meaning"},C=(c.usedUntil||(p["marker-end"]="url(#bedvisArrowBlue)"),j.createElement("line",p)),p=(g.appendChild(C),[5,10,15][c.frequency-1]),M=p+","+p;if(c.usedFrom){let e=x-Math.round((u[0].year-c.usedFrom)*i.pxYear);var B=0<(e=x-e<30?x-30:e)?e:0;for(let t=1;t<=2;t++){var T=1===t?"extension-norm":"extension-hover",I=j.createGradient({svg:n,x1:B,x2:B+25,fadeIn:!0,cl:T}),I=j.createElement("line",{x1:B,y1:w,x2:x,y2:w,stroke:`url(#${I})`,"stroke-dasharray":M,"stroke-width":b,class:T});g.appendChild(I)}}if(c.usedUntil&&1<u.length){C.classList.add("meaning-obsolete");let e=r+Math.round((c.usedUntil-u.at(-1).year)*i.pxYear),t=(e=(e=e-r<30?r+30:e)>j.dimensions.lineMax?j.dimensions.lineMax:e)-25;t<r&&(t=r);for(let a=1;a<=2;a++){var D=1===a?"extension-norm":"extension-hover",U=j.createGradient({svg:n,x1:t,x2:e,fadeIn:!1,cl:D}),U=j.createElement("line",{x1:r,y1:w,x2:e,y2:w,stroke:`url(#${U})`,"stroke-dasharray":M,"stroke-width":b,class:D});g.appendChild(U)}}for(A of u)"number"!=typeof A.id&&($=50+Math.round((A.year-i.first)*i.pxYear),F=j.createElement("circle",{cx:$,cy:w,r:y,class:"quotation","data-id":A.id}),g.appendChild(F),F=j.createElement("text",{x:$,y:w+y+3,"dominant-baseline":"hanging",class:"year"}),g.appendChild(F),F.textContent=A.yearText);this.ariaDesc({ele:g,def:E,lemma:o,quotFirst:u[0].year,quotLast:1<u.length?u.at(-1).year:0,usedBefore:c.usedFrom,usedUntil:c.usedUntil}),m+=v+4}}}}function L(e,t,a){for(var r,n=!/›.+‹/.test(t)&&!a,i=[];t.length;){var s=t.match(/^[^_]+/)?.[0];if(s)i.push({text:s}),t=t.substring(s.length);else{let e;s=t.match(/^_+/)[0],s=(e=1===s.length?"italic":2===s.length?"bold":"italic bold",t.match(/^_+(.+?)_+/));i.push({text:s[1],cl:e}),t=t.substring(s[0].length)}}for(r of i){var l=j.createElement("tspan",{"dominant-baseline":"hanging"});r.cl&&l.setAttribute("class",r.cl),l.textContent=r.text,e.appendChild(l)}n&&((n=j.createElement("tspan",{"dominant-baseline":"hanging"})).textContent="›",e.insertBefore(n,e.firstChild),(n=j.createElement("tspan",{"dominant-baseline":"hanging"})).textContent="‹",e.appendChild(n))}return m+=20},ariaDesc({ele:e,def:t,lemma:a,quotFirst:r,quotLast:n,usedBefore:i,usedUntil:s}){let l=`Der früheste Beleg des Worts „${a}“ in der Bedeutung „${t}“ stammt aus dem Jahr ${r}.`;i&&i<r?(l+=" Diese Bedeutung war vermutlich schon vorher im Gebrauch",n?(l+=` und ist noch für das Jahr ${n} belegt.`,s?s===n?l+=" Später wurde sie vermutlich nicht mehr verwendet.":s!==n&&(l+=` Vermutlich wurde sie auch nach ${n} für einige Zeit verwendet, heute aber nicht mehr.`):l+=" Sie wird noch heute verwendet."):l+=s?".":" und wird noch heute verwendet."):s||(l+=" Diese Bedeutung wird noch heute verwendet."),e.setAttribute("aria-label",l)},timeline(e,t,a){e.appendChild(j.createElement("line",{x1:0,y1:a,x2:j.dimensions.lineMax,y2:a,"stroke-width":3,"marker-end":"url(#bedvisArrowGrey)",class:"timeline"}));var r=Math.floor(50/t.pxYear),n=t.first-r,i=50-r*t.pxYear;let s,l;l=t.last-t.first<30?(s=parseInt(n.toString().replace(/[0-9]$/,"0"),10)-5,5):t.last-t.first<100?(s=parseInt(n.toString().replace(/[0-9]$/,"0"),10)-10,10):t.last-t.first<300?(s=100*parseInt(n.toString().substring(0,2),10),parseInt(n.toString().substring(2),10)<=50?s+=50:s+=100,50):(s=100*parseInt(n.toString().substring(0,2),10)+100,100);do{var d=i+Math.round((s-n)*t.pxYear);d<15?s+=l:((d=j.createElement("text",{x:d,y:a+6,"dominant-baseline":"hanging","text-anchor":"middle",class:"timeline-year"})).textContent=s,e.appendChild(d),s+=l)}while(s<t.last);return{minYear:n,minYearX:i}},events({svg:r,timespan:n,top:i,timelineData:e}){var t,{minYear:s,minYearX:l}=e;let d=0;for(t of Object.values(this.data.lemmas))if(t.events.length)for(var o of t.events){var h=j.createElement("g",{class:"timeline-event"}),m=(r.appendChild(h),j.pointerEvent(h),l+Math.round((o.yearFrom+Math.floor((o.yearTo-o.yearFrom)/2)-s)*n.pxYear));if(o.yearTo===o.yearFrom)h.appendChild(j.createElement("rect",{x:m-5,y:i-5,width:10,height:10,transform:`rotate(45, ${m}, ${i})`}));else{let e=l+Math.round((o.yearFrom-s)*n.pxYear),t=l+Math.round((o.yearTo-s)*n.pxYear);for(;t-e<10;)e--,t++;h.appendChild(j.createElement("line",{x1:e,y1:i,x2:t,y2:i,class:"timeline-event-span"}))}h.appendChild(j.createElement("line",{x1:m,y1:i+28,x2:m,y2:i,class:"timeline-event-marker"}));let e=""+o.yearFrom,t=(o.yearTo!==o.yearFrom&&(e+="–"+o.yearTo),`<b>${e}</b>`);o.description&&(t+=" / "+o.description);var c,p=j.createElement("text",{x:m,y:i+10,"dominant-baseline":"hanging","text-anchor":"middle","data-description":t});let a=0;for(c of o.name.split("\n")){a++;var u=j.createElement("tspan",{x:m,dy:20,"dominant-baseline":"hanging"});u.textContent=c,p.appendChild(u)}h.appendChild(p),a>d&&(d=a)}return d}};export default{makeSVG(e,t={}){return s.data=e,s.validateData(),s.svg(t)||null}};