let D={dimensions:{width:720,height:500,lineMax:710,groupHeights:[51,55,59]},calculateTimespan(){var e,t=[...document.querySelectorAll("#wgd-belegauswahl > div")];let a=0;for(e of Object.values(s.data.lemmas))for(var r of e.meanings)for(var n of r.quotations){n=this.getYear(n);n&&(!a||n<a)&&(a=n)}a=a||this.getYear(t[0].id);let i=this.getYear(t.at(-1)?.id||t.at(-1));t=(new Date).getFullYear();return t-i<10&&(i=t<i+10?t:i+10),{first:a=i-a<10?i-10:a,last:i,pxYear:(this.dimensions.width-90)/(i-a)}},createElement(e,t={}){var a,r,n=document.createElementNS("http://www.w3.org/2000/svg",e);for([a,r]of Object.entries(t))n.setAttribute(a,r);return n},createGradient({svg:e,x1:t,x2:a,fadeIn:r,cl:n=""}){var i=e.querySelector("defs"),s="bedvisGradOut"+i.querySelectorAll("linearGradient").length,l={id:s,x1:t,x2:a,gradientUnits:"userSpaceOnUse"},d=(n&&(l.class=n),this.createElement("linearGradient",l));for(let m=1;m<=2;m++){var o=r?m-1:m%2;d.appendChild(this.createElement("stop",{offset:m-1,"stop-opacity":o}))}return i.appendChild(d),s},pointerEvent(e){e.setAttribute("pointer-events","auto");var t=this.createElement("title");e.appendChild(t)},getYear(e){var t;return"number"==typeof e?e:(t=document.querySelector(`#${e} time`))&&(t=t.getAttribute("datetime").match(/^[0-9]{4}/)?.[0])?parseInt(t,10):0}},s={data:{},validateData(){for(var e of Object.values(this.data.lemmas)){for(var t of e.events)t.yearFrom>t.yearTo?t.yearTo=t.yearFrom:!t.yearFrom&&t.yearTo?t.yearFrom=t.yearTo:t.yearFrom&&!t.yearTo&&(t.yearTo=t.yearFrom);for(var a of e.meanings)a.frequency<1?a.frequency=1:3<a.frequency&&(a.frequency=3)}},svg(e){var t=Object.keys(this.data.lemmas);let a;var r={"aria-labelledby":"bedvis-title-"+(a=(a=this.data.lemmaList?this.data.lemmas.lemmas.meanings.flatMap(e=>e.definition):t).join(" ").replace(/ /g,"_").toLowerCase()),width:D.dimensions.width,height:D.dimensions.height,"pointer-events":"none",viewBox:`0 0 ${D.dimensions.width} `+D.dimensions.height,class:"bedvis"},r=(this.data.description&&(r["aria-describedby"]="bedvis-desc-"+a),this.data.lemmaList&&(r.class="bedvis lemma-list"),D.createElement("svg",r)),n=D.createElement("title",{id:"bedvis-title-"+a}),t=(r.appendChild(n),t.join("“, „").replace(/^(.+)(, )/,(...e)=>e[1]+" und ")),t=(n.textContent=`Bedeutungsentwicklung von „${t}“`,this.data.description&&(n=D.createElement("desc",{id:"bedvis-desc-"+a}),r.appendChild(n),n.textContent=this.data.description),this.defs(r),D.calculateTimespan()),n=this.meanings(r,t,e),i=this.timeline(r,t,n),t=n+26+22*this.events({svg:r,timespan:t,top:n,timelineData:i});return r.setAttribute("height",t),r.setAttribute("viewBox",`0 0 ${D.dimensions.width} `+t),r},defs(e){var t,a=D.createElement("defs");e.appendChild(a),a.appendChild(D.createElement("path",{id:"bedvisArrow",d:"M 0 0 L 10 5 L 0 10 C 5 2, 5 8, 0 0"}));for(t of["Grey","Blue","BlueHover"]){var r=D.createElement("marker",{id:"bedvisArrow"+t,viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"16",markerHeight:"16",markerUnits:"userSpaceOnUse",class:"arrow-"+t.toLowerCase()});r.appendChild(D.createElement("use",{href:"#bedvisArrow"})),a.appendChild(r)}},meanings(n,i,a){var s=this.data.lemmaList;let l={};s&&(document.querySelector(".wgd-kopf-hl")?.textContent?.split(/\s·\s/)?.forEach(e=>{l[e]=""}),document.querySelectorAll(".wgd-kopf-nl a").forEach(e=>{l[e.textContent]=e.getAttribute("href")}));var d,o,r,m=Object.keys(this.data.lemmas).length;let h=0;for([d,o]of Object.entries(this.data.lemmas)){1<m?(h+=16,(r=D.createElement("text",{x:D.dimensions.width/2,y:h,"dominant-baseline":"hanging","text-anchor":"middle",class:"lemma"})).textContent=d,n.appendChild(r),h+=40):h+=8;for(let t=0,e=o.meanings.length;t<e;t++){var c=o.meanings[t],p=document.getElementById(c.id);if(p||s){var u,f=[];for(u of c.quotations){var g=D.getYear(u);g&&f.push({id:u,year:g,yearText:"number"==typeof u?""+u:document.querySelector(`#${u} time`).textContent.replace(/[a-z]$/,"")})}if(f.length){t&&a.standalone&&(h+=15);var y=D.createElement("g"),v=(n.appendChild(y),D.pointerEvent(y),D.dimensions.groupHeights[c.frequency-1]),x=5+[0,2,4][c.frequency-1],b=50+Math.round((f[0].year-i.first)*i.pxYear);let r=D.dimensions.lineMax;c.usedUntil&&1<f.length&&(r=50+Math.round((f.at(-1).year-i.first)*i.pxYear));var w,C=[1,3,5][c.frequency-1],E=h+20+x,q=(y.appendChild(D.createElement("rect",{x:b,y:h,width:r-b,height:v,class:"blind"})),D.createElement("text",{x:b+x,y:h,"dominant-baseline":"hanging",class:"definition"})),k=c.definition||p?.querySelector("q")?.textContent||"[keine Angabe]";if(s)q.textContent=k;else{q.textContent=`›${k}‹`;let e=p.querySelector(".wgd-zaehlz")?.textContent,t=p.parentNode.parentNode;for(;"LI"===t.nodeName;){var Y=t.querySelector(".wgd-zaehlz")?.textContent;Y&&(e=Y+e),t=t.parentNode.parentNode}o.showNumbering&&e&&((w=D.createElement("tspan",{"dominant-baseline":"hanging"})).textContent=e+" ".repeat(2),q.insertBefore(w,q.firstChild))}let e;(e=s?(w=c.definition,void 0!==l[w]?l[w]:window.location.origin+"/wb/wortgeschichten/"+encodeURIComponent(w)):p.querySelector("a")?.getAttribute("href")||"")&&/^(#|http)/.test(e)?((p=D.createElement("a",{href:e,tabindex:-1,class:"definition"})).appendChild(q),y.appendChild(p)):y.appendChild(q);var S,$,F,p={x1:b,y1:E,x2:r,y2:E,"stroke-width":C,class:"meaning"},q=(c.usedUntil||(p["marker-end"]="url(#bedvisArrowBlue)"),D.createElement("line",p)),p=(y.appendChild(q),[5,10,15][c.frequency-1]),M=p+","+p;if(c.usedFrom){let e=b-Math.round((f[0].year-c.usedFrom)*i.pxYear);var A=0<(e=b-e<30?b-30:e)?e:0,B=f.some(e=>"string"==typeof e.id);for(let t=1;t<=2;t++){var T,I=1===t?"extension-norm":"extension-hover";let e;e=B||s?(T=D.createGradient({svg:n,x1:A,x2:A+25,fadeIn:!0,cl:I}),D.createElement("line",{x1:A,y1:E,x2:b,y2:E,stroke:`url(#${T})`,"stroke-dasharray":M,"stroke-width":C,class:I})):D.createElement("line",{x1:A,y1:E,x2:b,y2:E,"stroke-width":C,class:"extension "+I}),y.appendChild(e)}}if(c.usedUntil&&1<f.length){q.classList.add("meaning-obsolete");let e=r+Math.round((c.usedUntil-f.at(-1).year)*i.pxYear),t=(e=(e=e-r<30?r+30:e)>D.dimensions.lineMax?D.dimensions.lineMax:e)-25;t<r&&(t=r);for(let a=1;a<=2;a++){var U=1===a?"extension-norm":"extension-hover",L=D.createGradient({svg:n,x1:t,x2:e,fadeIn:!1,cl:U}),L=D.createElement("line",{x1:r,y1:E,x2:e,y2:E,stroke:`url(#${L})`,"stroke-dasharray":M,"stroke-width":C,class:U});y.appendChild(L)}}for(S of f)"number"!=typeof S.id&&($=50+Math.round((S.year-i.first)*i.pxYear),F=D.createElement("circle",{cx:$,cy:E,r:x,class:"quotation","data-id":S.id}),y.appendChild(F),F=D.createElement("text",{x:$,y:E+x+2,"dominant-baseline":"hanging",class:"year"}),y.appendChild(F),F.textContent=S.yearText);this.ariaDesc({ele:y,def:k,lemma:d,quotFirst:f[0].year,quotLast:1<f.length?f.at(-1).year:0,usedBefore:c.usedFrom,usedUntil:c.usedUntil}),h+=v+4}}}}return h+=20},ariaDesc({ele:e,def:t,lemma:a,quotFirst:r,quotLast:n,usedBefore:i,usedUntil:s}){let l=`Der früheste Beleg des Worts „${a}“ in der Bedeutung „${t}“ stammt aus dem Jahr ${r}.`;i&&i<r?(l+=" Diese Bedeutung war vermutlich schon vorher im Gebrauch",n?(l+=` und ist noch für das Jahr ${n} belegt.`,s?s===n?l+=" Später wurde sie vermutlich nicht mehr verwendet.":s!==n&&(l+=` Vermutlich wurde sie auch nach ${n} für einige Zeit verwendet, heute aber nicht mehr.`):l+=" Sie wird noch heute verwendet."):l+=s?".":" und wird noch heute verwendet."):s||(l+=" Diese Bedeutung wird noch heute verwendet."),e.setAttribute("aria-label",l)},timeline(e,t,a){e.appendChild(D.createElement("line",{x1:0,y1:a,x2:D.dimensions.lineMax,y2:a,"stroke-width":3,"marker-end":"url(#bedvisArrowGrey)",class:"timeline"}));var r=Math.floor(50/t.pxYear),n=t.first-r,i=50-r*t.pxYear;let s,l;l=t.last-t.first<30?(s=parseInt(n.toString().replace(/[0-9]$/,"0"),10)-5,5):t.last-t.first<100?(s=parseInt(n.toString().replace(/[0-9]$/,"0"),10)-10,10):t.last-t.first<300?(s=100*parseInt(n.toString().substring(0,2),10),parseInt(n.toString().substring(2),10)<=50?s+=50:s+=100,50):(s=100*parseInt(n.toString().substring(0,2),10)+100,100);do{var d=i+Math.round((s-n)*t.pxYear);d<15?s+=l:((d=D.createElement("text",{x:d,y:a+6,"dominant-baseline":"hanging","text-anchor":"middle",class:"timeline-year"})).textContent=s,e.appendChild(d),s+=l)}while(s<t.last);return{minYear:n,minYearX:i}},events({svg:r,timespan:n,top:i,timelineData:e}){var t,{minYear:s,minYearX:l}=e;let d=0;for(t of Object.values(this.data.lemmas))if(t.events.length)for(var o of t.events){var m=D.createElement("g",{class:"timeline-event"}),h=(r.appendChild(m),D.pointerEvent(m),l+Math.round((o.yearFrom+Math.floor((o.yearTo-o.yearFrom)/2)-s)*n.pxYear));if(o.yearTo===o.yearFrom)m.appendChild(D.createElement("rect",{x:h-5,y:i-5,width:10,height:10,transform:`rotate(45, ${h}, ${i})`}));else{let e=l+Math.round((o.yearFrom-s)*n.pxYear),t=l+Math.round((o.yearTo-s)*n.pxYear);for(;t-e<10;)e--,t++;m.appendChild(D.createElement("line",{x1:e,y1:i,x2:t,y2:i,class:"timeline-event-span"}))}m.appendChild(D.createElement("line",{x1:h,y1:i+28,x2:h,y2:i,class:"timeline-event-marker"}));let e=""+o.yearFrom,t=(o.yearTo!==o.yearFrom&&(e+="–"+o.yearTo),`<b>${e}</b>`);o.description&&(t+=" / "+o.description);var c,p=D.createElement("text",{x:h,y:i+10,"dominant-baseline":"hanging","text-anchor":"middle","data-description":t});let a=0;for(c of o.name.split("\n")){a++;var u=D.createElement("tspan",{x:h,dy:20,"dominant-baseline":"hanging"});u.textContent=c,p.appendChild(u)}m.appendChild(p),a>d&&(d=a)}return d}};export default{makeSVG(e,t={}){return s.data=e,s.validateData(),s.svg(t)||null}};