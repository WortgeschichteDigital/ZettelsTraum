<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'">

    <title>&nbsp;</title>

    <link rel="stylesheet" href="../css/win/hilfe.css">

    <script src="../js/win/init-dokumentation.mjs" type="module"></script>
  </head>
  <body>
    <!-- FENSTERLADEN -->
    <div id="fensterladen"><img src="../img/icon-app-weiss-48.svg" width="96" height="96" alt=""></div>

    <!-- KOPF -->
    <header>
      <h1>Technische Dokumentation</h1
      ><span id="kopf-icons"
        ><a href="#" id="hilfe-suchleiste" title="Suchleiste öffnen (F3)"
          ><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="m10.5 5a5.5 5.5 0 0 0-5.5 5.5 5.5 5.5 0 0 0 5.5 5.5 5.5 5.5 0 0 0 3.1172-0.96875l3.6621 3.6621a1 1 0 0 0 0.7207 0.30664 1 1 0 0 0 1-1 1 1 0 0 0-0.30273-0.7168l-3.6699-3.6699a5.5 5.5 0 0 0 0.97266-3.1133 5.5 5.5 0 0 0-5.5-5.5zm0 2a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5 3.5 3.5 0 0 1-3.5-3.5 3.5 3.5 0 0 1 3.5-3.5zm-7.5 10v4h2 7.4316 8.5684v-4h-1.3379c0.44598 0.76574 0.34692 1.7566-0.31055 2.4141-0.78347 0.78348-2.0447 0.78348-2.8281 0l-2.1211-2.1211c-0.091249-0.091249-0.17024-0.19026-0.24024-0.29297h-1.7305-7.4316-2zm2 1h7.4316v2h-7.4316v-2z"/></svg
        ></a
        ><a href="#" id="hilfe-drucken" title="Kapitel drucken (Strg + P)"
          ><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path transform="translate(4 4)" d="m4 1v2h8v-2h-8zm-2 3c-0.5 0-1 0.5-1 1v4c0 0.5 0.5 1 1 1h1v-2h10v2h1c0.5 0 1-0.5 1-1v-4c0-0.5-0.5-1-1-1h-12zm2 5v5h8v-5h-8z"/></svg
        ></a
      ></span
      ><img src="../img/icon-app-weiss-48.svg" width="48" height="48" alt="" id="icon">
    </header>

    <!-- GRID -->
    <main>
      <nav>
        <p class="suchform"><input type="text" value="" placeholder="Suche" id="suchfeld"
          ><a href="#" id="suchfeld-lupe" title="Suchergebnisse anzeigen"
            ><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path transform="translate(4 4)" d="m6.5 1a5.5 5.5 0 0 0-5.5 5.5 5.5 5.5 0 0 0 5.5 5.5 5.5 5.5 0 0 0 3.1172-0.969l3.6618 3.662a1 1 0 0 0 0.721 0.307 1 1 0 0 0 1-1 1 1 0 0 0-0.303-0.717l-3.67-3.6697a5.5 5.5 0 0 0 0.973-3.1133 5.5 5.5 0 0 0-5.5-5.5zm0 2a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5 3.5 3.5 0 0 1-3.5-3.5 3.5 3.5 0 0 1 3.5-3.5z"/></svg
          ></a
          ><a href="#" id="navi-back" title="rückwärts navigieren (Alt + ←)"
            ><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path transform="translate(4 4)" d="m14 7h-8l3.5-3.5-1.5-1.5-6 6 6 6 1.5-1.5-3.5-3.5h8z" fill="#212121"/></svg
          ></a
          ><a href="#" id="navi-forward" title="vorwärts navigieren (Alt + →)"
            ><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path transform="translate(4 4)" d="m2 9h8l-3.5 3.5 1.5 1.5 6-6-6-6-1.5 1.5 3.5 3.5h-8z" fill="#212121"/></svg
          ></a
        ></p>
        <ul>
          <li><a href="#framework" class="kopf">Framework</a></li>
          <li><a href="#ordner" class="kopf">Ordner und Dateien</a></li>
          <li><a href="#js" class="kopf">JavaScript</a></li>
          <li><a href="#ztj" class="kopf"><abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateiformat</a></li>
          <li><a href="#xml" class="kopf"><abbr title="Extensible Markup Language" lang="en">XML</abbr>-Snippets</a></li>
          <li><a href="#verschiedenes" class="kopf">Verschiedenes</a></li>
        </ul>
      </nav>
      <div>
        <!-- START -->
        <section id="sektion-start">
          <p class="obacht">Die technische Dokumentation ist nur für diejenigen gedacht, die das Programm bauen oder den Quellcode bearbeiten wollen!</p>

          <p>Allen anderen NutzerInnen hilft das <a href="#" class="link-handbuch">Handbuch</a> oder eine Suche im recht ausführlichen <a href="#" class="link-changelog">Changelog</a> vielleicht eher weiter.</p>

          <p>Im Handbuch finden sich einige technische – hoffentlich hilfreiche – <a href="#einfuehrung-benutzung" class="link-handbuch">Hinweise zur Benutzung</a>, die auch auf dieses Fenster zutreffen.</p>
        </section>

        <!-- SUCHE -->
        <section id="sektion-suche" class="aus">
          <h2>Suchergebnisse</h2>

          <div id="suchergebnisse"></div>
        </section>

        <!-- FRAMEWORK -->
        <section id="sektion-framework" class="suche aus">
          <!-- Electron -->
          <h2 id="framework-electron"><i>Electron</i>-Framework</h2>

          <p><i class="app-name"></i> läuft auf dem <a href="https://electronjs.org/"><i>Electron</i></a>-Framework. <i>Electron</i> ist eine Kombination der Rendering-Bibliothek von <a href="https://www.chromium.org/Home"><i>Chromium</i></a>, dem Open-Source-Browser, auf dem <i>Google Chrome</i> basiert, <a href="https://nodejs.org/"><i>Node.js</i></a>, einer JavaScript-Laufzeitumgebung mit der Implementierung <i>V8</i>, und den Electron APIs. Das Framework kann komplett via JavaScript gesteuert werden, weswegen zum Programmieren der App Kenntnisse in den Sprachen <abbr title="Hyptertext Markup Language" lang="en">HTML</abbr>, <abbr title="Cascading Style Sheets" lang="en">CSS</abbr> und JavaScript vollkommen ausreichen.</p>

          <p><i>Electron</i> übernimmt die schwierigen Aufgaben, die sich beim Programmieren einer Desktop-App stellen. Es kümmert sich um die Integration in das Betriebssystem, ermöglicht also lesende und schreibende Dateizugriffe sowie das Öffnen externer Programme, erzeugt die Dateidialoge zum Öffnen und Speichern der Karteien und verwaltet über den betriebssystemeigenen Fenstermanager die einzelnen Programmfenster, in denen eine auf die Rendering-Bibliothek eingedampfte Variante des <i>Chromium</i>-Browsers für die Anzeige zuständig ist. Jedes Programmfenster läuft in einem eigenen Renderer-Prozess, weswegen die einzelnen Fenster nicht direkt miteinander kommunizieren können. Das Öffnen der Programmfenster und die Darstellung der Fenstermenüs werden im Wesentlichten über den Main-Prozess gesteuert, über den die App initialisiert wird. Dieser wiederum kann mit allen Fenstern kommunizieren.</p>

          <p>Der Main-Prozess wird über das Script <span class="datei">./main.mjs</span> im Wurzelverzeichnis des Quellcodes gesteuert (das Wurzelverzeichnis, in dem der App-Code liegt, wird im Folgenden immer durch <span class="datei">./</span> bezeichnet). Vermittelt über diesen Prozess können die Fenster miteinander in Kommunikation treten. Über das Objekt <code class="quelltext">ipcMain</code> hört der Main-Prozess auf Meldungen der Renderer-Prozesse. Über die Kontextbrücke in der Datei <span class="datei">./js/main/preload.cjs</span>, dessen API in der globalen Variable <code class="quelltext">bridge</code> exponiert wird, können via <code class="quelltext">ipcRenderer</code> Kommandos an den Main-Prozess geschichte werden.</p>

          <p>Daneben erleichtert <i>Electron</i> das <a href="#framework-paketieren">Paketieren der App</a> für die Betriebssysteme <i>Linux</i>, <i>Windows</i> und <i>macOS</i> enorm. Außerdem können relativ leicht <a href="#framework-installer">Installer</a> für die einzelnen Betriebssysteme gebaut werden.</p>

          <p>Die <abbr title="Application Programming Interface" lang="en">API</abbr> von <i>Electron</i> ist sehr gut <a href="https://www.electronjs.org/docs/latest/api/app">dokumentiert</a>; das Framework-Motto <q lang="en">It’s easier than you think</q>, somit gar nicht falsch. Für einen raschen Einstieg empfiehlt sich das <a href="https://www.electronjs.org/docs/latest/tutorial/tutorial-prerequisites">Einstiegstutorial</a>.</p>

          <!-- Download Quelltext -->
          <h2 id="framework-download">Download des Quelltexts</h2>

          <p>Mit jedem <a href="https://github.com/WortgeschichteDigital/ZettelsTraum/releases">Release</a> von <i class="app-name"></i> wird ein Tarball veröffentlicht, in dem sich ein Snapshot des Quellcodes befindet, wie er zum Zeitpunkt des Releases im Branch <code class="quelltext">main</code> aussah. Möchte man den Quelltext bearbeiten, kann man auf der Basis der archivierten Ordner und Dateien arbeiten.</p>

          <p>Bequemer ist es natürlich das GitHub-Repository einfach zu klonen:</p>

          <pre>$ git clone https://github.com/WortgeschichteDigital/ZettelsTraum.git zettelstraum</pre>

          <p>Im Repository findet sich ausschließlich der Branch <code class="quelltext">main</code>, der immer auf dem Stand des letzten Releases gehalten wird.</p>

          <p>Eine weitere Möglichkeit, um an den Quelltext zu gelangen: Er ist auch in den <a href="#framework-quelltext">paketierten Versionen der App</a> enthalten und dort in einem speziellen Archiv im Programmordner zu finden.</p>

          <!-- Installation -->
          <h2 id="framework-installation">Installation von <i>Electron</i></h2>

          <p>Im Folgenden wird die Einrichtung von <i>Electron</i> auf einer <i>Linux</i>-Distribution beschrieben, die auf <a href="https://www.ubuntu.com/"><i>Ubuntu</i></a> basiert. Die Anweisungen dürften aber für alle Betriebssysteme ähnlich sein, denn auch unter <i>Windows</i> wird <i>Node.js</i> <abbr title="beispielsweise">bspw.</abbr> über die Eingabeaufforderung gesteuert.</p>

          <p>Zunächst muss <i>Node.js</i> mit seinem Paketmanager <code>npm</code> installiert werden (für <i>Windows</i> und <i>macOS</i> gibt es <a href="https://nodejs.org/en/download/">eigene Installer</a>):</p>

          <pre>$ sudo apt-get install nodejs</pre>

          <p>Über die Eingaben <code>node -v</code> und <code>npm -v</code> bekommt man die Versionsnummern von <i>Node.js</i> <abbr title="beziehungsweise">bzw.</abbr> dessen Paketmanager angezeigt – ein einfacher Test, ob die Installation geklappt hat. Im Falle des Paketmanagers könnte ein Update ratsam sein:</p>

          <pre>$ sudo npm install -g npm@latest</pre>

          <p>Global lassen sich Programme aus dem <i>Node.js</i>-Respository mithilfe des Schalters <code>-g</code> und Rootrechten (hier erlangt via <code>sudo</code>) installieren:</p>

          <pre>$ sudo npm install -g [PROGRAMM]</pre>

          <p><i>Electron</i> sollte allerdings nicht global, sondern lokal, <abbr title="das heißt">d.&nbsp;h.</abbr> im App-Ordern, installiert werden, sonst gibt es bei der späteren Paketierung mitunter Probleme. Das Zeichen für den aktuellen Pfad (<span class="datei">./</span>) steht hier und im Folgenden für das Wurzelverzeichnis der App, in dem <abbr title="unter anderem">u.&nbsp;a.</abbr> die Datei <span class="datei">./package.json</span> liegt. Die Installation ist simpel:</p>

          <pre>$ cd ./
$ npm install --save-dev electron</pre>

          <p>Während der Installation werden der Ordner <span class="datei">./node_modules/</span> und die Datei <span class="datei">./package-lock.json</span> erzeugt. Der Ordner <span class="datei">./node_modules/</span> kann mehrere Hundert Megabyte groß sein!</p>

          <p>Entwickeln Sie mit <a href="https://git-scm.com/">Git</a>, bietet es sich an, diese zu <i>Electron</i> und nicht zur App gehörenden Pfade in die <span class="datei">.gitignore</span> einzutragen:</p>

          <pre class="quelltext">/node_modules/
/package-lock.json</pre>

          <p>Da im Herzen von <i>Electron</i> ein Browser schlägt und Browser fortwährend mit Sicherheitsupdates versorgt werden wollen, gibt es sehr häufig (<abbr title="in der Regel">i.&nbsp;d.&nbsp;R.</abbr> alle ein bis zwei Wochen) <a href="https://releases.electronjs.org/release?channel=stable"><i>Electron</i>-Updates</a>. Das Update funktioniert genauso wie die Erstinstallation:</p>

          <pre>$ npm install --save-dev electron</pre>

          <p>Welche <i>Electron</i>-Version im App-Ordner installiert ist, kann man dem Fenster <a href="#" class="ueber-electron"><i>Über Electron</i></a> (auch aufzurufen über das Menü <i>Hilfe</i> im Hauptfenster von <i class="app-name"></i>) oder der <span class="datei">./package.json</span> entnehmen:</p>

          <pre class="quelltext">"devDependencies": {
  "electron": "^27.1.2",
  ...
}</pre>

          <p>Soll eine neue Major-Version installiert werden, muss an dieser Stelle der Wert des Schlüssels <code class="quelltext">electron</code> geändert werden. <code class="quelltext">^28</code> ermöglicht bspw. die Installation der Electron-Version&nbsp;28. Wenn die Versionsnummer nicht manuell angepasst wird, werden nur Dot-Releases installiert.</p>

          <p>Über die aktuelle Version im <i>Node.js</i>-Respository gibt der Paketmanager Auskunft:</p>

          <pre>$ npm show electron version</pre>

          <p>Der jüngste stabile Versionszweig von <i>Electron</i> liefert zum Zeitpunkt der Veröffentlichung immer die aktuelle Ausgabe von <i>Chromium</i> mit, hebt die <i>Chromium</i>-Version mit den folgenden Minor-Releases aber nicht mehr an. Technisch ist der im Framework arbeitende Browser somit zwar meist leicht veraltet, um die notwendigen Sicherheitsupdates kümmert sich das <i>Electron</i>-Team aber <a href="https://www.electronjs.org/docs/latest/tutorial/electron-timelines">für einige Monate</a>, ehe ein Release-Zweig <abbr title="End-of-life" lang="en">EOL</abbr> erreicht.</p>

          <p>Man muss nicht notwendigerweise die neuste Electron-Version nutzen. Es ist durchaus möglich einen bestimmten Release-Zweig zu installieren oder upzudaten. Um <abbr title="beispielsweise">bspw.</abbr> die Version&nbsp;25.0.x zu verwenden, müsste die Eingabe so aussehen:</p>

          <pre>$ npm install --save-dev electron@25-x-y</pre>

          <p>Darüber, welche Zweige alle zur Verfügung stehen, gibt dieses Kommando Auskunft:</p>

          <pre>$ npm view electron</pre>

          <p>All das, was hier erklärt wurde, brauchen Sie nicht unbedingt händisch ausführen. Es genügt im Grunde, wenn Sie <i>Node.js</i> installieren. Danach können Sie es sich leicht machen und ein mitgeliefertes Script aufrufen, das den Rest für Sie übernimmt – zumindest wenn Ihre Entwicklungsumgebung unter <i>Linux</i> läuft:</p>

          <pre>$ bash ./build/build-modules.sh</pre>

          <p>Installiert werden dabei die nötigen Module zum Ausführen und Bauen von <i class="app-name"></i>. Sind diese bereits installiert, wird ein Update angestoßen – falls noch eins aussteht. Das Ausführen des Scripts erzeugt den Ordner <span class="datei">node_modules</span> und die Datei <span class="datei">package-lock.json</span> im App-Verzeichnis. In der <span class="datei">package.json</span> werden die Werte in <code class="quelltext">"devDependencies"</code> aufgefrischt.</p>

          <!-- Starten -->
          <h2 id="framework-starten">Starten der App</h2>

          <p>Wie die App gestartet werden soll, wird in der Datei <span class="datei">./package.json</span> festgelegt. Die <span class="datei">./package.json</span> enthält neben Meta-Informationen zu Programm, Autor und Lizenz nämlich auch Scripts zum Starten von <i class="app-name"></i>. Die folgende Zeile legt fest, über welche Script-Datei der Main-Prozess initialisiert wird:</p>

          <pre class="quelltext">"main": "main.mjs",</pre>

          <p>Und unter <code class="quelltext">"scripts"</code> steht die Information, wie das Programm gestartet werden soll:</p>

          <pre class="quelltext">"scripts": {
  "start": "electron ."
}</pre>

          <p>(An dieser Stelle könnte man auch Scripts zum <a href="#framework-paketieren">Paketieren der App</a> einfügen. Hierfür steht allerdings ein mitgeliefertes, deutlich komfortableres Node-Script zur Verfügung.)

          <p>Für den Start der App ist bereits alles eingerichtet. Nach der Installation von <i>Electron</i> muss man im Programmordner nur noch den folgenden Befehl ausführen:</p>

          <pre>$ npm start</pre>

          <p>Nun sollte <i class="app-name"></i> im Entwickler-Modus gestartet werden. <abbr title="Das heißt">D.&nbsp;h.</abbr> konkret, dass sich über das Tastaturkürzel <kbd class="nochange">Strg</kbd> + <kbd>⇧</kbd> + <kbd>I</kbd> die <i lang="en">Developer Tools</i> von <i>Chromium</i> öffnen lassen, die in der paketierten Version nicht mehr aufgerufen werden können. Außerdem erscheint in der Menüleiste des Hauptfensters der Menüpunkt <i>Dev</i>, der beim Paketieren eliminiert wird.</p>

          <!-- Paketieren -->
          <h2 id="framework-paketieren">Paketieren der App</h2>

          <p>Das Paketieren von <i class="app-name"></i> ist denkbar einfach. Zunächst muss der <a href="https://github.com/electron/packager">Packager von <i>Electron</i></a> installiert werden (haben Sie das Script <span class="datei">build-modules.sh</span> ausgeführt, ist dies bereits geschehen):</p>

          <pre>$ cd ./
$ npm install --save-dev electron-packager</pre>

          <p>Den Packager könnte man durchaus über die Kommandozeile bedienen:</p>

          <pre>$ electron-packager . zettelstraum [OPTIONEN]</pre>

          <p>Der <code>.</code> steht für das Quellverzeichnis und <code>zettelstraum</code> für den App-Namen.</p>

          <p>Besser ist es jedoch, ihn über ein Node-Script zu steuern. Das macht das Ganze variabler und deutlich übersichtlicher. Über die zur Verfügung stehenden Optionen gibt die <a href="https://electron.github.io/packager/main/modules.html"><abbr title="Application Programming Interface" lang="en">API</abbr></a>-Dokumentation des Packagers ausführlich Auskunft.</p>

          <p>Im Prinzip muss man sich mit dieser Dokumentation allerdings nicht weiter beschäftigen, da für das Paketieren bereits alles eingerichtet ist: In der Datei <span class="datei">./build/build.mjs</span> befindet sich ein Node-Script, das das Erstellen von <i>Linux-</i>, <i>Windows-</i> und <i>macOS</i>-Paketen übernimmt. Die paketierte Version von <i class="app-name"></i> wird nach dem Ausführen eine Ebene oberhalb des Wurzelverzeichnisses in einem Ordner namens <span class="datei">build</span> abgelegt. Existiert der Ordner nicht, wird er automatisch erzeugt. Die Option <code class="quelltext">overwrite: true</code> sorgt dafür, dass alte Paketierungen im Ordner <span class="datei">../build</span> vor dem erneuten Paketieren entfernt werden. Das Script kann über die folgenden Befehle ausgeführt werden. Gibt man den Build-Ordner explizit an, wird dieser anstelle von <span class="datei">../build</span> genutzt. (Die Reihenfolge der Argumente kann frei gewählt werden</p>

          <ul>
            <li>
              <p>Für <i>Linux</i>:</p>

              <pre>$ node build/build.mjs packager linux [Build-Ordner]</pre>
            </li>

            <li>
              <p>Für <i>Windows</i>:</p>

              <pre>$ node build/build.mjs packager win32 [Build-Ordner]</pre>
            </li>

            <li>
              <p>Für <i>macOS</i>:</p>

              <pre>$ node build/build.mjs packager darwin [Build-Ordner]</pre>
            </li>
          </ul>

          <p>Das mitgelieferte Script erstellt Pakete für eine 64-Bit-Architektur. Dies kann natürlich nach Belieben angepasst werden. Wie, darüber gibt die besagte <a href="https://electron.github.io/packager/main/modules.html"><abbr title="Application Programming Interface" lang="en">API</abbr></a> des Packagers Auskunft.</p>

          <p>Im Ordner <span class="datei">../build</span> befinden sich nun die Unterordner <span class="datei">zettelstraum-linux-x64</span>, <span class="datei">zettelstraum-win32-x64</span> <abbr title="beziehungsweise">bzw.</abbr> <span class="datei">zettelstraum-darwin-x64</span>. Die Unterordner enthalten eine ausführbare Datei, über die die App gestartet werden kann:</p>

          <ul>
            <li><i>Linux</i>: <span class="datei">zettelstraum-linux-x64/zettelstraum</span></li>

            <li><i>Windows</i>: <span class="datei">zettelstraum-win32-x64/zettelstraum.exe</span></li>

            <li><i>macOS</i>: <span class="datei">zettelstraum-darwin-x64/Zettel’s Traum.app/Contents/MacOS/zettelstraum</span></li>
          </ul>

          <p>Unter <i>macOS</i> ist die angegebene ausführbare Datei nur interessant, wenn das Programm über die Kommandozeile (also via <i>Terminal</i>) gestartet werden soll. Ansonsten reicht natürlich ein Doppelklick auf den Ordner <span class="datei">Zettel’s Traum.app</span>. Das System erkennt automatisch, dass dahinter ein Programm der Ausführung harrt und startet es.</p>

          <p>Auch wenn die ausführbare Programmdatei (im Falle von <i>Linux</i> und <i>Windows</i>) um die 100&nbsp;Megabyte groß ist – ohne die anderen Dateien und Verzeichnisse, die sich im Paketordner befinden, kann die App nicht gestartet werden. Möchte man sie auf ein anderes Betriebssystem kopieren, muss also immer der gesamte Ordner mit allen Dateien mitgenommen werden.</p>

          <p>Wenn Sie unter <i>Linux</i> arbeiten: Die <span class="datei">build.mjs</span> kann durch das <a href="#framework-bashScript">Bash-Script</a> gesteuert werden. Dort besteht auch die Option, das Paket in einem Archiv zu komprimieren.</p>

          <!-- Installer -->
          <h2 id="framework-installer">Installer bauen</h2>

          <p>Ein bisschen schwieriger als die alleinige Paketierung ist das Bauen von Installern für die verschiedenen Betriebssysteme und Architekturen. Im Folgenden wird beschrieben, wie man mithilfe von <a href="https://github.com/electron-userland/electron-builder">electron-builder</a> Installer für <i>Windows</i> (<abbr title="Nullsoft Scriptable Install System" lang="en">NSIS</abbr>), <i>macOS</i> (<abbr title="Apple Disk Image" lang="en">DMG</abbr>)  und <i>Linux</i> (DEB <abbr title="oder">od.</abbr> RPM) erzeugt.</p>

          <p>Zunächst muss der Builder via <code>npm</code> installiert werden:</p>

          <pre>$ cd ./
$ npm install --save-dev electron-builder</pre>

          <p>Die richtige Konfiguration des Builders zu finden, ist nicht so leicht, denn er kennt eine Vielzahl an <a href="https://www.electron.build/configuration">Konfigurationsmöglichkeiten</a>. Für das Erstellen von <abbr title="Nullsoft Scriptable Install System" lang="en">NSIS</abbr>-Installern, von <abbr title="Apple Disk Image" lang="en">DMG</abbr>-, DEB- und RPM-Paketen sowie von AppImages ist in dem mitgelieferten Node-Script, das sich der <a href="https://www.electron.build/programmatic-usage" lang="en">Programmatic API</a> des Builders bedient, bereits alles eingerichtet:</p>

          <ul>
            <li>
              <p><i>Linux</i>:</p>

              <pre>$ node build/build.mjs builder linux [appImage|deb|rpm] [Build-Ordner]</pre>
            </li>

            <li>
              <p><i>Windows</i>:</p>

              <pre>$ node build/build.mjs builder win32 [nsis] [Build-Ordner]</pre>
            </li>

            <li>
              <p><i>macOS</i>:</p>

              <pre>$ node build/build.mjs builder darwin [dmg] [Build-Ordner]</pre>
            </li>
          </ul>

          <p><abbr title="Apple Disk Image" lang="en">DMG</abbr>-Pakete können nur unter <i>macOS</i> gebaut werden, wo man sich zunächst natürlich die entsprechende Entwicklungsumgebung eingerichtet haben muss. Darum konnte <span class="obacht">nicht getestet</span> werden, ob der Installer wirklich funktionstüchtige Images auswirft.</p>

          <p>Wird kein Argument angegeben, das den Pakettyp spezifiziert, baut das Script für Linux ein DEB-Paket, für Windows einen <abbr title="Nullsoft Scriptable Install System" lang="en">NSIS</abbr>-Installer und für macOS ein <abbr title="Apple Disk Image" lang="en">DMG</abbr>-Paket.</p>

          <p>Wenn kein Build-Ordner übergeben wurde, wird vor dem Start des eigentlichen Bauvorgangs überprüft, ob eine Ebene oberhalb des App-Verzeichnisses ein Ordner namens <span class="datei">build</span> existiert. Er wird <abbr title="gegebenenfalls">ggf.</abbr> automatisch erzeugt.</p>

          <p>Der Linux-Installer erwartet für DEB- und RPM-Pakete, dass in <span class="datei">../build</span> eine Plain-Text-Datei mit dem Namen <span class="datei">changelog</span> liegt. Ist kein Changelog vorhanden, wird automatisch eine leere Datei erzeugt. Werden die Linux-Pakete mit der <a href="#framework-bashScript"><span class="datei">./build/build.sh</span></a> gebaut, wird automatisch versucht, mit den Daten im lokalen Git-Repository einen Changelog zu erstellen. Ist kein Repository vorhanden, wird auch in diesem Fall allein eine leere Datei namens <span class="datei">changelog</span> erzeugt.</p>

          <p>Nach <abbr title="circa">ca.</abbr> ein, zwei Minuten (die genaue Zeit hängt natürlich vom Rechner, aber auch vom gewählten Installer ab), sollte eine Meldung wie <code>Linux-Paketierung erstellt!</code> erscheinen. Kommt diese Meldung, kann es eigentlich nicht zu größeren Fehlern gekommen sein. Im Verzeichnis <span class="datei">../build</span> befinden sich nun ein Ordner und mehrere Dateien. Interessant ist natürlich nur die Installer-Datei:</p>

          <p class="datei">zettelstraum_[VERSION]_[ARCHITEKTUR].(AppImage|deb|dmg|exe|rpm)</p>

          <p>Die ausführbare exe-Datei kann nun auf einen Windows-Rechner kopiert und installiert werden. (Getestet wurde die Installation nur auf <i>Windows&nbsp;10</i> und <i>11</i>.)</p>

          <p>Die DEB-Datei kann mit <span lang="en">Debian Package</span> installiert werden:</p>

          <pre>$ sudo dpkg -i zettelstraum*.deb</pre>

          <p>Die Abhängigkeiten des RPM-Pakets kann man sich so anzeigen lassen:</p>

          <pre>$ rpm -qp --requires zettelstraum*.rpm</pre>

          <p>Der <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateityp sollte während der Installation automatisch registriert werden – und zwar sowohl durch den <i>Windows-</i> als auch durch die <i>Linux</i>-Installer. (Der <i>macOS</i>-Installer wurde wie gesagt nicht getestet.) Für den Fall, dass Probleme auftreten, finden sich im Programmordner Scripts, mit denen die Registrierung des Dateityps unter <i>Linux</i> manuell vor- oder zurückgenommen werden kann. Die Scripts liegen in <span class="datei">/opt/zettelstraum/resources/filetype/linux/</span> und können mit <code>bash</code> ausgeführt werden.</p>

          <pre>$ bash [de]register.sh</pre>

          <p>Für diesen Vorgang werden <abbr title="eventuell">evtl.</abbr> Root-Rechte benötigt.</p>

          <p>Bei der Installation unter <i>Linux</i> werden übrigens auch Dateityp-Icons abgelegt: <span class="datei">/usr/share/icons/hicolor/*/mimetypes/application-x-ztj.png</span>, und zwar jeweils in den Unterordnern <span class="datei">16x16</span>, <span class="datei">22x22</span>, <span class="datei">32x32</span>, <span class="datei">48x48</span>, <span class="datei">64x64</span> und <span class="datei">128x128</span>.</p>

          <h2 id="framework-bashScript">Bash-Script</h2>

          <p>Das Node-Script <span class="datei">./build/build.mjs</span> lässt sich über ein mitgeliefertes Bash-Script ausführen:</p>

          <pre>$ bash build/build.sh</pre>

          <p>Nach dem Aufruf kann man das Script über Texteingaben steuern. Das Ergebnis eines Bauvorgangs wird standardmäßig im erwähnten Ordner <span class="datei">../build/</span> abgelegt. Die Optionen und Fragen im Script sind reichlich knapp gehalten. Darum hier ein paar kurze Erläuterungen.</p>

          <p>Aufgaben, die ausgeführt werden können:</p>

          <ul>
            <li><i>job:</i> Startet die Konfiguration eines einzelnen Build-Jobs. Das Script fragt nach und nach ab, was genau getan werden soll, und führt den Job dann aus.</li>

            <li><i>release:</i> Führt <code>bash build/build-release.sh</code> aus. Das Script bereitet verschiedene Dateien und das lokale Git-Repository nach und nach für ein Release vor, führt das Bauen von Paketen aber nicht durch.</li>

            <li><i>preset:</i> Startet ein in den ersten Zeilen des Scripts definiertes Preset, das aus mehreren Jobs bestehen kann. Die Presets können natürlich nach Belieben ergänzt oder geändert werden.</li>

            <li><i>sha:</i> Erstellt die Datei <span class="datei">../build/sha256sums.txt</span>, in der SHA256-Summen aller zum Zeitpunkt der Erstellung im Ordner <span class="datei">../build/</span> liegenden Ordner und Dateien gespeichert werden.</li>

            <li><i>config:</i> Startet die Konfigurationsabfrage, aber keinen Job. Stattdessen wird nur der Konfigurationsstring ausgeworfen. Hilfreich, wenn man sich einen Preset anlegen möchte.</li>

            <li><i>modules:</i> Führt <code>bash build/build-modules.sh</code> aus. Das Script installiert die benötigten Node-Module oder führt ein Update bereits installierter Module aus.</li>

            <li><i>exit:</i> Verlässt das Script.</li>
          </ul>

          <p>Zu den Abfragen, die beim Konfigurieren eines Jobs gestellt werden:</p>

          <ul>
            <li><i>Typ:</i> Hier geht es darum, ob Installer erstellt werden sollen oder portable Pakete. Außerdem kann ein Tarball mit dem Quellcode erzeugt werden. Hierfür muss jedoch <a href="https://git-scm.com/">Git</a> eingerichtet sein.</li>

            <li><i>OS:</i> Das Betriebssystem, auf dem Paket oder Installer laufen soll.</li>

            <li><i>Format:</i> Das Format des Installers, das natürlich nur abgefragt wird, wenn ein Installer erstellt werden soll. Das Format der Paketierungen hängt allein vom gewählten Betriebssystem ab.</li>

            <li><i>Archiv:</i> Pakete liegen nach dem Bauen, anders als Installer, nur als Ordnerstruktur vor. Auf Wunsch kann man sie in einem Archiv komprimieren. Tarballs werden immer mit <abbr title="GNU zip">gzip</abbr> komprimiert, weswegen für diese keine Abfrage des Archivformats erfolgt.</li>

            <li><i>Aufräumen:</i> Der Ordner <span class="datei">../build/</span> kann nach dem Erledigen eines Build-Jobs automatisch bereinigt werden. Temporäre Dateien werden gelöscht, es bleiben nur Installer, Archive und nicht archivierte Paketordner erhalten.</li>
          </ul>

          <!-- Ordner -->
          <h2 id="framework-ordner">Programm- und Konfigurationsordner</h2>

          <p>Der <strong><abbr title="Nullsoft Scriptable Install System" lang="en">NSIS</abbr>-Installer</strong> legt das Programm nach Doppelklick in einem lokalen User-Ordner ab: <span class="datei">C:\Users\[BENUTZERNAME]\AppData\Local\Programs\zettelstraum\</span>. Soll eine neuere Version installiert werden, muss man <i class="app-name"></i> nur beenden (<abbr title="zum Beispiel">z.&nbsp;B.</abbr> via <kbd>Strg</kbd> + <kbd>Q</kbd>), auf der Installer-Datei doppelklicken und das war’s.</p>

          <p>Deinstalliert werden kann das Programm wie jede andere App über die Systemsteuerung von <i>Windows</i>.</p>

          <p>Die <strong>Linux-Installer</strong> erstellen einen Programmordner unter <span class="datei">/opt/zettelstraum/</span> und legen eine Desktop-Datei im Ordner <span class="datei">/usr/share/applications/</span> ab: <span class="datei">zettelstraum.desktop</span>. Das Programm sollte sich nach der Installation also ganz normal über das Programm-Menü des Betriebssystems starten lassen.</p>

          <p>Darüber hinaus wird auch eine Verknüpfung in <span class="datei">/usr/local/bin/</span> angelegt. Die App kann somit problemlos über ein Terminal mit dem Befehl <code>zettelstraum</code> gestartet werden.</p>

          <p>Das DEB-Paket kann mit dem Paketmanager deinstalliert werden:</p>

          <pre>$ sudo apt-get purge zettelstraum</pre>

          <p>Die Registrierung des <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateityps sollte dabei automatisch rückgängig gemacht werden (<abbr title="vergleiche">vgl.</abbr> dazu den Abschnitt <a href="#framework-installer">Installer bauen</a>).</p>

          <p>Für <strong>macOS</strong> konnte das Ganze mangels System mit einer entsprechenden Entwicklungsumgebung <span class="obacht">nicht getestet</span> werden.</p>

          <p id="framework-konfigurationsverzeichnis">Ob die App nun paketiert und installiert ist oder einfach via <code>npm start</code> aufgerufen wurde, das <i>Electron</i>-Framework erstellt automatisch einen Konfigurationsordner im Standard-Konfigurationsverzeichnis des Betriebssystems:</p>

          <ul>
            <li><i>Linux</i>: <span class="datei">~/.config/<span class="app-name"></span>/</span></li>

            <li><i>Windows</i>: <span class="datei">C:\Users\[BENUTZERNAME]\AppData\Roaming\<span class="app-name"></span>\</span></li>

            <li><i>macOS</i>: <span class="datei">~/Library/Application Support/<span class="app-name"></span>/</span></li>
          </ul>

          <p>Die Dateien in dem Ordner werden alle von <i>Electron</i> verwaltet – bis auf die Datei <span class="datei">einstellungen.json</span>. Diese wird durch den Main-Prozess erstellt. In ihr werden die Einstellungen des Hauptfensters der App und die Größe und Position von einigen (aber nicht allen) Programmfenstern gespeichert. Welche Werte die App anlegt, lässt sich dem Objekt <code class="quelltext">optionen.data</code> in der Datei <span class="datei">./js/app/optionen.mjs</span> entnehmen.</p>

          <!-- Quelltext -->
          <h2 id="framework-quelltext">Quelltext in der paketierten und installierten App</h2>

          <p>Durch die Option <code class="quelltext">asar: true</code> wird der Quelltext beim <a href="#framework-paketieren">Paketieren</a> in einer Archivdatei abgelegt: <span class="datei">app.asar</span>. Sie befindet sich an dieser Stelle:</p>

          <ul>
            <li><i>Linux</i>: <span class="datei">zettelstraum-linux-x64/resources/app.asar</span></li>

            <li><i>Windows</i>: <span class="datei">zettelstraum-win32-x64/resources/app.asar</span></li>

            <li><i>macOS</i>: <span class="datei">zettelstraum-darwin-x64/zettelstraum.app/Contents/Resources/app.asar</span></li>
          </ul>

          <p>Der Quelltext der App wird auch beim Installieren im jeweiligen Installationsordner abgelegt:</p>

          <ul>
            <li><i>Linux</i>: <span class="datei">/opt/zettelstraum/resources/app.asar</span></li>

            <li><i>Windows</i>: <span class="datei">C:\Users\[BENUTZERNAME]\AppData\Local\Programs\zettelstraum\resources\app.asar</span></li>

            <li><i>macOS</i>: <span class="datei">???/app.asar</span></li>
          </ul>

          <p><a href="https://github.com/electron/asar">Asar</a> ist das Archiv-Programm von <i>Electron</i>, das ähnlich wie <code>tar</code> funktioniert: Der Inhalt ist nicht komprimiert, es werden schlicht Ordner und Dateien in einem Archiv zusammengefasst.</p>

          <p>Entpacken lässt das Archiv sich via:</p>

          <pre>$ npx asar extract app.asar [ZIELORDNER]</pre>

          <p>Enthalten ist der vollständige Quelltext von <i class="app-name"></i>. Allerdings fehlen in der installierten App die Dateien aus dem Ordner <span class="datei">./resources/*</span>. Sie liegen bereits entpackt im selben Ordner wie die <span class="datei">app.asar</span>.</p>
        </section>

        <!-- ORDNER UND DATEIEN -->
        <section id="sektion-ordner" class="suche aus">
          <p>Im Folgenden wird summarisch beschrieben, welche Ordner und Dateien sich im Quellcode befinden, um die Orientierung für den Einsteig ein wenig zu erleichtern.</p>

          <!-- Root -->
          <h2 class="datei" id="ordner-root">./</h2>

          <ul>
            <li><span class="datei">./index.html</span>: <abbr title="Hyptertext Markupt Language" lang="en">HTML</abbr>-Datei, die beim Öffnen des Hauptfensters geladen wird</li>

            <li><span class="datei">./LICENSE*</span>: Lizenzbestimmungen von <i class="app-name"></i>, den eingebundenen Icons und Fonts</li>

            <li><span class="datei">./main.mjs</span>: Node-Script, das die App initialisiert, die Programmfenster öffnet, lädt, verwaltet und für viele andere Dinge zuständig ist, was das Betriebssystem, auf dem <i class="app-name"></i> läuft, direkt betrifft</li>

            <li><span class="datei">./package.json</span>: <abbr title="JavaScript Object Notation" lang="en">JSON</abbr>-Datei mit Meta-Informationen zu Programm, Autor und Lizenz sowie Angaben darüber, wie die App gestartet wird; <abbr title="vergleiche">vgl.</abbr> den Abschnitt <a href="#framework-starten">Starten der App</a></li>

            <li><span class="datei">./README.md</span>: Markdown-Datei mit den wichtigsten Infos zu <i class="app-name"></i>. Sie wurde für die Anzeige im <a href="https://github.com/WortgeschichteDigital/ZettelsTraum">GitHub-Repository</a> erstellt.</li>
          </ul>

          <!-- Build -->
          <h2 class="datei" id="ordner-build">./build/</h2>

          <p>Scripts und Resourcen, die für das Bauen von Installern genutzt werden (können). Sie werden im laufenden Betrieb von <i class="app-name"></i> nicht ausgeführt.</p>

          <ul>
            <li>
              <p><span class="datei">./build/build.sh</span>: Build-Script, mit dem die App komfortabel paketiert werden kann. Das Script kann unter <i>Linux</i> via <code>bash build.sh</code> ausgeführt werden. Die Parameter werden über Texteingaben abgefragt.</p>

              <p>Im Script können auch Presets angelegt werden, um mehrere Pakete verschiedener Natur mit einem Befehl zu bauen. Die Presets kann man in die ersten Zeilen der Datei schreiben; Muster sind bereits enthalten.</p>
            </li>

            <li><span class="datei">./build/build-modules.sh</span>: Der Aufruf des Scripts installiert die nötigen <i>Electron</i>-Module im App-Ordner. Sind sie bereits installiert, führt es ein Update aus. Das Script kann auch aus der Datei <span class="datei">build.sh</span> heraus aufgerufen werden.</li>

            <li><span class="datei">./build/build-release.sh</span>: Das Script bereitet verschiedene Dateien und das lokale Git-Repository für ein Release vor. Dafür muss natürlich <a href="https://git-scm.com/">Git</a> installiert und ein Repository vorhanden sein. Das Script kann auch aus der Datei <span class="datei">build.sh</span> heraus aufgerufen werden.</li>

            <li>
              <p><span class="datei">./build/build.mjs</span>: Node-Script, das die Paketierung der App übernimmt. Welche Argumente übergeben werden können, steht in der Hilfe:</p>

              <pre>$ node build.mjs --help</pre>
            </li>

            <li>
              <p><span class="datei">./build/linux-after-install.sh</span>: Shell-Befehle, die beim Erstellen von DEB- und RPM-Paketen mit eingebunden und während der Installation ausgeführt werden können. Sie erzeugen einen Symlink zum Programm und führen die Dateityp-Assoziierung durch.</p>

              <p>Die Scripts sind <span class="obacht">nur für dieses Szenario</span> gedacht! Wollen Sie die Dateityp-Assoziierung wieder aufheben oder neu erstellen, nutzen Sie lieber die Scripts im <a href="#ordner-resources">Filetype-Ordner</a>.</p>
            </li>

            <li><span class="datei">./build/linux-after-remove.sh</span>: Shell-Befehle, die von DEB- und RPM-Paketen nach der Deinstallation ausgeführt werden.</li>

            <li><span class="datei">./build/mac-brackground.png</span>: Hintergrundbild für <abbr title="Apple Disk Image" lang="en">DMG</abbr>-Pakete. Es wird vom entsprechenden Installer-Script genutzt.</li>
          </ul>

          <!-- CSS -->
          <h2 class="datei" id="ordner-css">./css/</h2>

          <p>Der Ordner enthält die Stylesheets aller Fenster.</p>

          <ul>
            <li><span class="datei">./css/*.css</span>: Stylesheets, die in mehr als einem Fenster benötigt werden und durch <code class="quelltext">@include</code> in andere Stylesheets eingebunden werden</li>

            <li><span class="datei">./css/app/*.css</span>: Stylesheets, die im Hauptfenster des Programms geladen werden; in der <span class="datei">app.css</span> finden sich viele basale Definitionen, die anderen Dateien regeln das Layout einzelner Teile oder Funktionen der App</li>

            <li><span class="datei">./css/win/*.css</span>: diese Stylesheets werden nur in den vom Hauptfenster abhängigen Nebenfenstern (also <abbr title="unter anderem">u.&nbsp;a.</abbr> dem <a href="#" class="link-handbuch">Handbuch</a> und diesem Fenster) benötigt</li>
          </ul>

          <!-- Fonts -->
          <h2 class="datei" id="ordner-fonts">./fonts/</h2>

          <p>Der Ordner enthält die Schriftarten, die durch die Datei <span class="datei">./css/fonts.css</span> geladen werden.</p>

          <!-- Images -->
          <h2 class="datei" id="ordner-img">./img/</h2>

          <ul>
            <li><span class="datei">./img/*.svg</span>: Vektorgrafiken, die sowohl für das Hauptfenster der App als auch für deren Nebenfenster genutzt werden; nicht alle Grafiken werden aus diesem Ordner geladen, mitunter sind sie als <abbr title="Extensible Markup Language" lang="en">XML</abbr> direkt in den Quelltext der <abbr title="Hyptertext Markup Language" lang="en">HTML</abbr>-Dateien eingefügt worden</li>

            <li><span class="datei">./img/icon/</span>: Bilddateien mit dem Programm-Icon in verschiedenen Größen für unterschiedliche Betriebssysteme; für <i>Windows</i> gibt es eine <span class="datei">icon.ico</span>, für <i>macOS</i> eine <span class="datei">icon.icns</span> und für <i>Linux</i> einen Ordner mit <abbr title="Portable Network Graphics" lang="en">PNG</abbr>-Dateien</li>

            <li><span class="datei">./img/menu/*.png</span>: Bilddateien, die nur von den Menüs verwendet werden, die das Framework verwaltet; dazu zählen das App-Menü am oberen Rand des Hauptfensters und die Kontextmenüs, die auf Rechtsklick erscheinen</li>

            <li><span class="datei">./img/readme/*.png</span>: Bilddateien, die in der <span class="datei">./README.md</span> angezeigt werden</li>

            <li><span class="datei">./img/win/*.png</span>: Bilddateien, die nur von Nebenfenstern (<a href="#" class="link-handbuch">Handbuch</a>, diese Dokumentation <abbr title="und so weiter">usw.</abbr>) geladen werden</li>
          </ul>

          <!-- JavaScript -->
          <h2 class="datei" id="ordner-js">./js/</h2>

          <p>Der Ordner enthält alle JavaScript-Dateien, die von den Renderer-Prozessen geladen werden. Im Unterordner <span class="datei">./js/app/</span> liegen Dateien, die ausschließlich vom Hauptfenster genutzt werden, und in <span class="datei">./js/win/</span> Dateien, die ausschließlich in Nebenfenstern geladen werden. In <span class="datei">./js/main/</span> wiederum finden sich Module, die allein der Main-Prozess (<span class="datei">main.mjs</span>) benutzt. Auf der obersten Ebene (<span class="datei">./js/</span>) liegen geteilte Scripts, die von mehreren Fenstern genutzt werden, aber nicht vom Main-Prozess.</p>

          <p>Jede JavaScript-Datei enthält ein Objekt, das denselben Namen wie die Datei hat. Es gibt allerdings Ausnahmen: Die Dateien mit dem Namensmuster <span class="datei">init-*.js</span>. In ihnen werden Events desjeningen Fensters initialisiert, zu dem die Datei gehört. Sie sind zugleich das erste und einzige Modul, das über die jeweilige <abbr title="Hyptertext Markup Language">HTML</abbr>-Datei im <a href="#ordner-win">Ordner <span class="datei">./win/</span></a> (und über die <span class="datei">index.html</span>) geladen wird.</p>

          <p>Die Namen der JavaScript-Dateien zeigen im Großen und Ganzen an, welche Funktionalität sie bereitstellen. Da es sich bei allen Scripts um <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">ES-Module</a> handelt, kann man ihre Abhängikeiten anhand der Importanweisungen in den ersten Zeilen erkennen.</p>

          <!-- File type -->
          <h2 class="datei" id="ordner-resources">./resources/</h2>

          <p>Der Unterordner <span class="datei">./resources/filetype/</span> enthält Icons für den <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateityp und Shell-Scripts, mit denen auf <i>Linux</i>-Systemen der Dateityp registriert oder entfernt werden kann. (Es gibt auch eine <abbr title="Scalable Vector Graphics">SVG</abbr>-Version des Dateityp-Icons: <span class="datei">./img/datei-ztj.svg</span>.)</p>

          <p>Außerdem finden sich in dem Ordner <abbr title="Extensible Markup Language">XML</abbr>-Dateien mit Tag-Listen und eine <a href="#" class="hilfe-demo">Demonstrationskartei</a>, die im Programm für die Bedeutungsgerüst-Funktion genutzt werden können.</p>

          <!-- Fenster -->
          <h2 class="datei" id="ordner-win">./win/</h2>

          <p>Der Ordner enthält die <abbr title="Hypertext Markup Language">HTML</abbr>-Dateien, die in den Nebenfenstern geladen werden.</p>
        </section>

        <!-- JAVASCRIPT -->
        <section id="sektion-js" class="suche aus">
          <h2 id="js-code">JavaScript-Code</h2>

          <p>Der JavaScript-Code ist <i lang="en">vanilla;</i> es wurden keine Bibliotheken wie <i>jQuery</i> oder dergleichen verwendet. Da der Code <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">modularisiert</a> ist, befindet sich jedes Script automatisch im <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode"><i lang="en">strict mode</i></a>.</p>

          <p>Beim Coden wurde der Grundregel gefolgt, Struktur, Layout und Funktion strikt voneinander zu trennen. In den <abbr title="Hypertext Markup Language" lang="en">HTML</abbr>-Dateien finden sich darum weder <abbr title="Cascading Style Sheets" lang="en">CSS</abbr>-Style-Attribute noch Inline-Event-Handler. Die an Elemente gebundenen Events werden alle über Module initialisiert, die <span class="datei">init-*.mjs</span> heißen. Diese Dateien sind zugleich die ersten und einzigen Module, die über die <abbr title="Hyptertext Markup Language">HTML</abbr>-Dateien geladen werden.</p>

          <p>Der JavaScript-Code wurde extensiv kommentiert. Im Ergebnis sollte immer nachvollziehbar sein, welche Aufgabe das Script an der jeweiligen Stelle erfüllt. So wird <abbr title="zum Beispiel">z.&nbsp;B.</abbr> bei jeder Funktion angegeben, wozu sie dient und welchen Variablentyp die Argumente haben.</p>

          <p>Die Funktionen sind in aller Regel in Objekte verpackt: In jeder JavaScript-Datei befindet sich ein einziges Objekt, das exakt denselben Namen wie die Datei trägt und zahlreiche Eigenschaften und Methoden hat. Eine Ausnahme von diesem Schema bilden allein die Scripts des Main-Prozesses und Dateien mit dem Namensmuster <span class="datei">init-*.mjs</span>. In letzteren werden Event-Objekte des Fensters initialisiert, zu dem die jeweilige Datei gehört. Das betreffende Fenster lässt sich leicht aus dem Dateinamen ableiten.</p>

          <p><abbr title="Vergleiche">Vgl.</abbr> zu den JavaScript-Dateien die Anmerkungen im Kapitel <a href="#ordner-js">Ordner und Dateien</a>.</p>

          <p>Im globalen Namensraum findet sich die Variable <code class="quelltext">bridge</code>. Sie wird über die Datei <span class="datei">./js/main/preload.cjs</span> initialisiert und stellt Funktionen für den Austausch zwischen <a href="#framework">Main- und Renderer-Prozess</a> zur Verfügung. Dass Electron- und Node-Module in den Renderer-Prozessen nicht importiert werden, sondern alle Anfragen über den Main-Prozess laufen, ist ein wichtiger Baustein in der Sicherheitsarchitektur der App. Ein Beispiel für die Kommunikation zwischen Main- und Renderer-Prozess:</p>

          <p>Im Main-Prozess (<span class="datei">./main.mjs</span>) gibt es Event-Handler, die auf Anfragen über die <i lang="en">context bridge</i> hören. Zum Beispiel:</p>

          <pre class="quelltext">ipcMain.handle("get-info", evt => {
  // code
});</pre>

          <p>Aus dem Renderer-Prozess heraus kann eine Anfrage an den Channel (hier <code class="quelltext">get-info</code>) geschickt werden, der durch ein <code class="quelltext">return</code> Daten zurückliefern kann:</p>

          <pre class="quelltext">const info = await bridge.ipc.invoke("get-info");</pre>

          <p>Daneben können im Renderer-Prozess Listener initialisiert werden, die auf Anfragen des Main-Prozesses reagieren:</p>

          <pre class="quelltext">bridge.ipc.listen("popup-link", () => {
  // code
});</pre>

          <p>Das in allen Fenstern geladene Modul <span class="datei">./js/dd.mjs</span> stellt einige wichtige Variablen bereit:</p>

          <ul>
            <li>
              <p><code class="quelltext">app</code>: In diesem <span class="datentyp">Object</span> werden einige Eigenschaften gespeichert, die nur vom Main-Prozess unmittelbar abgefragt werden können. Auf diese Weise stehen sie unmittelbar in allen <a href="#kurzanleitung-programmfensterHauptfenster" class="link-handbuch">Haupt-</a> und <a href="#kurzanleitung-programmfensterNebenfenster" class="link-handbuch">Nebenfenstern</a> zur Verfügung. Es handelt sich im Einzelnen um:</p>

              <ul>
                <li><code class="quelltext">app.appPath</code> (<span class="datentyp">String</span>): Pfad zur App;</li>

                <li><code class="quelltext">app.documents</code> (<span class="datentyp">String</span>): Pfad zum Dokumente-Ordner des Rechners;</li>

                <li><code class="quelltext">app.lang</code> (<span class="datentyp">String</span>): Sprache des Betriebssystems;</li>

                <li><code class="quelltext">app.name</code> (<span class="datentyp">String</span>): Name der App, also <code class="quelltext">"<span class="app-name"></span>"</code>;</li>

                <li><code class="quelltext">app.os</code> (<span class="datentyp">Object</span>): Informationen zum Betriebsystem: <code class="quelltext">arch</code>, <code class="quelltext">hostname</code>, <code class="quelltext">type</code>, <code class="quelltext">username</code>;</li>

                <li><code class="quelltext">app.packaged</code> (<span class="datentyp">Boolean</span>): die App wurde paketiert;</li>

                <li><code class="quelltext">app.pathSep</code> (<span class="datentyp">String</span>): Pfad-Separator, also <code class="quelltext">/</code> oder <code class="quelltext">\</code>;</li>

                <li><code class="quelltext">app.platform</code> (<span class="datentyp">String</span>): Platform, auf der die App läuft (<code class="quelltext">darwin&nbsp;| linux&nbsp;| win32</code>);</li>

                <li><code class="quelltext">app.resourcesPath</code> (<span class="datentyp">String</span>): Pfad zum Ressourcenordner;</li>

                <li><code class="quelltext">app.temp</code> (<span class="datentyp">String</span>): Pfad zum temporären Ordner des Rechners;</li>

                <li><code class="quelltext">app.userData</code> (<span class="datentyp">String</span>): Pfad zum Konfigurationsordner des Rechners;</li>

                <li><code class="quelltext">app.version</code> (<span class="datentyp">String</span>): Versionsnummer der App;</li>

                <li><code class="quelltext">app.versions</code> (<span class="datentyp">Object</span>): Versionen von Bestandteilen des Frameworks: <code class="quelltext">chrome</code>, <code class="quelltext">electron</code>, <code class="quelltext">node</code>, <code class="quelltext">v8</code>.</li>
              </ul>
            </li>

            <li><code class="quelltext">file</code>: In diesem <span class="datentyp">Object</span> liegen die Daten der aktuellen Kartei, also die Inhalt der geöffneten <a href="#ztj-ztj">ZTJ-Datei</a>. Dieses Objekt ist naturgemäß nur in Hauptfenstern gefüllt.</li>

            <li>
              <p><code class="quelltext">win</code>: Analog zu <code class="quelltext">app</code> stellt das <span class="datentyp">Object</span> allen Programmfenstern Eigenschaften bereit, die sonst nur im Main-Prozess unmittelbar zugänglich sind. Es handelt sich im Einzelnen um:</p>

              <ul>
                <li><code class="quelltext">win.winId</code> (<span class="datentyp">Number</span>): ID des aktuellen Fensters;</li>

                <li><code class="quelltext">win.contentsId</code> (<span class="datentyp">Number</span>): ID des WebContents des aktuellen Fensters;</li>

                <li><code class="quelltext">win.typ</code> (<span class="datentyp">String</span>): Typ des Fensters: <code class="quelltext">index&nbsp;| bedeutungen&nbsp;| changelog&nbsp;| dokumentation&nbsp;| handbuch&nbsp;| fehlerlog&nbsp;| xml&nbsp;| app&nbsp;| electron</code>.</li>
              </ul>
            </li>
          </ul>
        </section>

        <!-- ZTJ-DATEIFORMAT -->
        <section id="sektion-ztj" class="suche aus">
          <!-- ZTJ-Format -->
          <h2 id="ztj-ztj"><abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Format</h2>

          <p>Die <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateien sind <abbr title="GNU zip">gzip</abbr>-komprimierter Plain-Text im <abbr title="JavaScript Object Notation">JSON</abbr>-Format.</p>

          <p>Nach dem Laden einer <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Datei in <i class="app-name"></i> befinden sich die <abbr title="JavaScript Object Notation">JSON</abbr>-Daten im globalen Objekt <code class="quelltext">data</code>. Ihre Werte lassen sich dann in allen Funktionen des Hauptfensters durch einfache Statements wie <code class="quelltext">data.dc</code> lesen oder schreiben.</p>

          <p>Alle Dateien sind gleich aufgebaut (<span class="obacht">Datenformat Version&nbsp;26</span>):</p>

          <table class="ztj">
            <tr>
              <th>Schlüssel</th>
              <th>Datentyp</th>
              <th>Format</th>
              <th>Funktion</th>
            </tr>
            <tr>
              <td><code class="quelltext">an</code></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>Anhänge; Pfade zu Dateien, die an die Kartei angehängt wurden; die Pfade können absolut oder relativ zum Speicherort der Kartei sein</td>
            </tr>
            <tr>
              <td><code class="quelltext">bd</code></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Bedeutungsgerüste;<br><span class="obacht">ab Version&nbsp;5 gefüllt</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">gn</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">/[0-9]+/</code>,<br>Start mit <code class="quelltext">1</code></td>
              <td>ID des aktiven Gerüsts</td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">gr</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Speicherobjekt für alle Gerüste</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Es folgen beliebig viele <span class="datentyp">Objects</span> mit einmaligen Schlüsseln:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p>(ID)</p></td>
              <td class="datentyp">Object</td>
              <td><code class="quelltext">/[0-9]+/</code>,<br>Start mit <code class="quelltext">1</code></td>
              <td>Bedeutungsgerüst</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">bd</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Bedeutungen</td>
            </tr>
            <tr class="ztj-ebene4">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">al</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Alias der Bedeutung</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">bd</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt,<br><code class="quelltext">&lt;b&gt;</code>, <code class="quelltext">&lt;i&gt;</code>, <code class="quelltext">&lt;u&gt;</code>,<br><code class="quelltext">&lt;mark<br>class="paraphrase"&gt;</code><br>möglich</td>
              <td>Bedeutung mit dem kompletten Bedeutungspfad; im letzten Slot steht die Bedeutung dieses Eintrags, darüber die vererbten, übergeordneten Bedeutungen</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">1 – ∞</code></td>
              <td>ID der Bedeutung</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">ta</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Tags</td>
            </tr>
            <tr class="ztj-ebene5">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene5">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Tags; zeigt auf <code class="quelltext">optionen.data.tags[ty].data[id]</code></td>
            </tr>
            <tr class="ztj-ebene5">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Typ des Tags; zeigt auf <code class="quelltext">optionen.data.tags[ty]</code></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">za</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Zählzeichen der Bedeutung; also z.&nbsp;B. <code class="quelltext">"1"</code> oder <code class="quelltext">"a"</code></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">na</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Name des Gerüsts</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">sl</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">0–2</code></td>
              <td>Start-Level der Zählung; <code class="quelltext">0</code>&nbsp;= A, <code class="quelltext">1</code>&nbsp;= I, <code class="quelltext">2</code>&nbsp;= 1</td>
            </tr>
            <tr class="ztj-alt">
              <td><code class="quelltext">be</code></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>BearbeiterInnen, die die Kartei geändert haben;<br><span class="obacht">mit Version&nbsp;13 nach <code class="quelltext">data.rd.be</code> verschoben</span></td>
            </tr>
            <tr>
              <td><code class="quelltext">dc</code></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Kartei erstellt wurde</td>
            </tr>
            <tr>
              <td><code class="quelltext">dm</code></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Kartei zuletzt geändert wurde</td>
            </tr>
            <tr>
              <td><code class="quelltext">fv</code></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Formvarianten zum Wort der Kartei, die aus dem <abbr title="Deutschen Textarchiv">DTA</abbr> geladen und/oder manuell eingegeben wurden;<br><span class="obacht">mit Version&nbsp;9 von einem <span class="datentyp">Array</span> in ein <span class="datentyp">Object</span> konvertiert</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td colspan="4"><p>Es folgen beliebig viele <span class="datentyp">Objects</span> mit einmaligen Schlüsseln:</p></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p>(WORT)</p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>eines der Wörter, aus denen das Karteiwort besteht</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>In jedem <span class="datentyp">Object</span> die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">an</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td><code class="quelltext">true</code> = Wort wird für die <a href="#menueKartei-formvariantenFunktionen" class="link-handbuch">verschiedensten Funktionen</a> berücksichtigt;<br><code class="quelltext">false</code> = Wort wird überhaupt nicht berücksichtigt</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">fa</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">0–17</code></td>
              <td>Markierungsfarbe;<br><span class="obacht">mit Version&nbsp;10 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">fo</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Formvarianten;<br><span class="obacht">bis Version&nbsp;8 war dieses <span class="datentyp">Array</span> identisch mit <code class="quelltext">data.fv</code></span></td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">qu</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">"dta"</code> oder <code class="quelltext">"zt"</code></td>
              <td>Quelle der Formvariante; mit <code class="quelltext">"zt"</code> markierte Varianten wurden manuell ergänzt</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">va</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Formvariante</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ma</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Wort nur markieren, <a href="#menueKartei-formvariantenNurMarkieren" class="link-handbuch">für gewisse Funktionen</a> jedoch ignorieren;<br><span class="obacht">mit Version&nbsp;10 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">nl</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Nebenlemma (Wort, das zusätzlich zum Hauptwort der Kartei behandelt wird); ähnliche wie <code class="quelltext">ma</code>;<br><span class="obacht">mit Version&nbsp;16 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ps</code></p></td>
              <td class="datentyp">String</td>
              <td>Part-of-speech-Tag</td>
              <td>Wortart, genauer: ein <a href="http://kaskade.dwds.de/~moocow/mirror/projects/moot/">Part-of-speech-Tag</a>;<br><span class="obacht">mit Version&nbsp;10 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">tr</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Wort trunkiert markieren, sprich: links und rechts erweitern;<br><span class="obacht">mit Version&nbsp;10 ergänzt</span></td>
            </tr>
            <tr class="ztj-alt">
              <td><code class="quelltext">ha</code></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>reserviert für die Kartenhaufen-Funktion;<br><span class="obacht">mit Version&nbsp;7 entfernt</span></td>
            </tr>
            <tr>
              <td><code class="quelltext">ka</code></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Karteikarten</td>
            </tr>
            <tr class="ztj-ebene1">
              <td colspan="4"><p>Es folgen beliebig viele <span class="datentyp">Objects</span> mit einmaligen Schlüsseln:</p></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p>(ID)</p></td>
              <td class="datentyp">Object</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>Karteikarte</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>In jedem <span class="datentyp">Object</span> die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">an</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>Anhänge; Pfade zu Dateien, die an die Karteikarte angehängt wurden; die Pfade können absolut oder relativ zum Speicherort der Kartei sein</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">au</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Autor des Belegs</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bb</code></p></td>
              <td class="datentyp">Number</td>
              <td>&nbsp;</td>
              <td>Seite bis zu der das XML aus einer Datei importiert wurde;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">bc</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Buchung (Beleg wurde im Artikel zitiert);<br><span class="obacht">mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">bd</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Bedeutung; mehrere Bedeutungen durch <code class="quelltext">\n</code> voneinander getrennt; neue Hierarchie beginnt mit <code class="quelltext">":&nbsp;"</code>;<br><span class="obacht">Version&nbsp;1–4</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bv</code></p></td>
              <td class="datentyp">Number</td>
              <td>&nbsp;</td>
              <td>Seite von der ab das XML aus einer Datei importiert wurde;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bd</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Bedeutungen;<br><span class="obacht">ab Version&nbsp;5</span></td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">gr</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">/[0-9]+/</code>,<br>Start mit <code class="quelltext">1</code></td>
              <td>ID des Bedeutungsgerüsts</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">1 – ∞</code></td>
              <td>ID der Bedeutung</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">be</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">0–5</code></td>
              <td>Markierung mit Sternen; <code class="quelltext">0</code>&nbsp;= unmarkiert, <code class="quelltext">5</code>&nbsp;= 5&nbsp;Sterne</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bi</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Importtyp; bezieht sich auf die importierten Daten, die in <code class="quelltext">bx</code> gespeichert werden;<br>alle Importtypen: <code class="quelltext">bibtex</code>, <code class="quelltext">html</code>, <code class="quelltext">plain</code>, <code class="quelltext">plain-dereko</code> (bis Version&nbsp;26 <code class="quelltext">dereko</code>), <code class="quelltext">tei</code>, <code class="quelltext">tei-copadocs</code>, <code class="quelltext">tei-dibilit</code>, <code class="quelltext">tei-dibiphil</code>, <code class="quelltext">tei-dingler</code>, <code class="quelltext">tei-dta</code>, <code class="quelltext">tei-humboldt</code>, <code class="quelltext">tei-jeanpaul</code>, <code class="quelltext">tei-soldatenbriefe</code>, <code class="quelltext">tei-stimmlos</code>, <code class="quelltext">tei-wdb</code>, <code class="quelltext">xml-dwds</code> (bis Version&nbsp;26 <code class="quelltext">dwds</code>), <code class="quelltext">xml-fundstelle</code>, <code class="quelltext">xml-mods</code>, <code class="quelltext">xml-wgd</code>;<br><span class="obacht">mit Version&nbsp;25 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bl</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Wortbildung; mehrere Wortbildungen durch <code class="quelltext">\n</code> voneinander getrennt; neue Hierarchie beginnt mit <code class="quelltext">":&nbsp;"</code>;<br><span class="obacht">mit Version&nbsp;3 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bs</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Belegtext; kann <abbr title="Hyptertext Markup Language">HTML</abbr>-Tags enthalten</td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">bu</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Bücherdienst (Beleg muss am Original überprüft werden);<br><span class="obacht">mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bx</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Beleg im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-, <span class="bibtex"><span>Bib</span>T<span>E</span>X</span>- oder Plain-Text-Format, <abbr title="das heißt">d.&nbsp;h.</abbr> die Originaldaten des <a href="#karteikarte-importfunktion" class="link-handbuch">Beleg-Imports</a>;<br><span class="obacht">mit Version&nbsp;12 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">da</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Belegdatum; Freitext, enthalten sein muss aber zwingend <code class="quelltext">/[0-9]{4}/</code> und/oder <code class="quelltext">/[0-9]{2}\.&nbsp;Jh\./</code></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">dc</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Karteikarte erstellt wurde</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">di</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem der Beleg importiert wurde;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">dm</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Karteikarte zuletzt gespeichert wurde</td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">ko</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Kontext (der Kontext des Belegs ist zu dürftig und muss am Original begutachtet werden);<br><span class="obacht">mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">kr</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Korpus, aus dem der Beleg stammt;<br><span class="obacht">mit Version&nbsp;2 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">mt</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Metatext (Beleg ist mit einer analytischen Haltung gegenüber dem Karteiwort verfasst);<br><span class="obacht">mit Version&nbsp;8 ergänzt; mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">no</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Notizen zur Karteikarte</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">qu</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Quellenangabe</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">sy</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Synonym; mehrere Synonyme durch <code class="quelltext">\n</code> voneinander getrennt; neue Hierarchie beginnt mit <code class="quelltext">":&nbsp;"</code><br><span class="obacht">mit Version&nbsp;4 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">tg</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Tags;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ts</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">\n</code> möglich</td>
              <td>Textsorte; mehrere Textsorten durch <code class="quelltext">\n</code> voneinander getrennt; neue Hierarchie beginnt mit <code class="quelltext">":&nbsp;"</code></td>
            </tr>
            <tr class="ztj-ebene2 ztj">
              <td><p><code class="quelltext">ud</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">&quot;YYYY-MM-DD&quot;</code></td>
              <td>Aufrufdatum;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj">
              <td><p><code class="quelltext">ui</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Import-URL;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj">
              <td><p><code class="quelltext">ul</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>URL;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">un</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Beleg unvollständig (er muss weiter bearbeitet werden);<br><span class="obacht">mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">up</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>Beleg ungeprüft (er muss noch Korrektur gelesen werden);<br><span class="obacht">mit Version&nbsp;21 ergänzt; mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr>
              <td><p><code class="quelltext">la</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Lemmaliste;<br><span class="obacht">mit Version&nbsp;26 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">er</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>ergänzende Kartei für die angegebenen Hauptlemmata</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">hl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Hauptlemma (Schreibungen verbunden mit <code class="quelltext">/</code>)</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ho</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]/</code></td>
              <td>Homographenindex</td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">la</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Lemmata</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ho</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]/</code></td>
              <td>Homographenindex</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ko</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Kommentar zum Lemma</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">nl</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>ist Nebenlemma <abbr title="beziehungsweise">bzw.</abbr> Feldlemma (in Wortfeldartikeln)</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">sc</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>Schreibungen des Lemmas <abbr title="beziehungsweise">bzw.</abbr> der Titel (in Wortfeldartikeln)</td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">wf</code></p></td>
              <td class="datentyp">Boolean</td>
              <td>&nbsp;</td>
              <td>ist Wortfeldartikel</td>
            </tr>
            <tr>
              <td><p><code class="quelltext">le</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>Lexika, die überprüft wurden</td>
            </tr>
            <tr>
              <td><p><code class="quelltext">no</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Notizen zur Kartei; kann <abbr title="Hyptertext Markup Language" lang="en">HTML</abbr>-Tags enthalten;<br><span class="obacht">mit Version&nbsp;6 von <i lang="en">plain text</i> auf <abbr title="Hyptertext Markup Language" lang="en">HTML</abbr> umgestellt</span></td>
            </tr>
            <tr>
              <td><p><code class="quelltext">rd</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Redaktionsdaten</td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">be</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>BearbeiterInnen, die die Kartei geändert haben;<br><span class="obacht">bis Version&nbsp;12 befand sich dieses <span class="datentyp">Array</span> in <code class="quelltext">data.be</code></span></td>
            </tr>
            <tr class="ztj-ebene1 ztj-alt">
              <td><p><code class="quelltext">bh</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Wort, mit dem zusammen das aktuelle Karteiwort behandelt wird;<br><span class="obacht">ab Version&nbsp;13; mit Version&nbsp;26 gelöscht</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">er</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Redaktionsereignisse;<br><span class="obacht">bis Version&nbsp;12 war dieses <span class="datentyp">Array</span> identisch mit <code class="quelltext">data.rd</code></span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">da</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2019-12-01"</code></td>
              <td>Tagesdatum des Ereignisses</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">er</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Redaktionsereignis</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">no</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Notiz;<br><span class="obacht">ab Version&nbsp;23</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">pr</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>BearbeiterIn</td>
            </tr>
            <tr class="ztj-ebene1 ztj-alt">
              <td><p><code class="quelltext">nl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>kommagetrennte Liste mit Nebenlemmata, die mit dem aktuellen Karteiwort behandelt werden;<br><span class="obacht">ab Version&nbsp;20; mit Version&nbsp;26 entfernt</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">no</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Notizen;<br><span class="obacht">ab Version&nbsp;22</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">sg</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Sachgebiete, zu denen das Karteiwort gehört;<br><span class="obacht">ab Version&nbsp;13</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Sachgebiet-Tags; zeigt auf <code class="quelltext">optionen.data.tags.sachgebiete.data[id]</code></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>immer <code class="quelltext">"sachgebiete"</code></td>
              <td>Tag-Typ, der in diesem Fall immer derselbe ist; <abbr title="vergleiche">vgl.</abbr> <code class="quelltext">data.bd.gr[ID].bd.ta</code></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">sp</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Kategorie der Stichwortplanung;<br><span class="obacht">ab Version&nbsp;24</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Stichwortplanungs-Tags; zeigt auf <code class="quelltext">optionen.data.tags.stichwortplanung.data[id]</code></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>immer <code class="quelltext">"stichwortplanung"</code></td>
              <td>Tag-Typ, der in diesem Fall immer derselbe ist; <abbr title="vergleiche">vgl.</abbr> <code class="quelltext">data.bd.gr[ID].bd.ta</code></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">tf</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Themenfelder, zu denen das Karteiwort gehört;<br><span class="obacht">ab Version&nbsp;14</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Themenfeld-Tags; zeigt auf <code class="quelltext">optionen.data.tags.themenfelder.data[id]</code></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>immer <code class="quelltext">"themenfelder"</code></td>
              <td>Tag-Typ, der in diesem Fall immer derselbe ist; <abbr title="vergleiche">vgl.</abbr> <code class="quelltext">data.bd.gr[ID].bd.ta</code></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">wi</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Wortinformationen;<br><span class="obacht">ab Version&nbsp;15</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">gn</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">/[0-9]+/</code>,<br>Start mit 1</td>
              <td>Bedeutungsgerüst-ID;<br><span class="obacht">ab Version&nbsp;17</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">lt</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">Textverweis<br>| Verweis intern<br>| Verweis extern</code></td>
              <td>Linktyp</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">tx</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Verweistext, also das verlinkte Wort/der verlinkte Ausdruck</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">vt</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">Wortbildung<br>| Wortfeld<br>| Wortfeldartikel<br>| Wortverbindung</code></td>
              <td>Verweistyp;<br><span class="obacht">mit Version&nbsp;17 <code class="quelltext">Assoziation</code> in <code class="quelltext">Wortbildung</code> umbenannt</span>;<br><span class="obacht">mit Version&nbsp;18 <code class="quelltext">Kollokation</code> in <code class="quelltext">Wortverbindung</code> umbenannt</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>alle Daten im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Daten des <a href="#menueRedaktion-xml" class="link-handbuch"><abbr title="Extensible Markup Language" lang="en">XML</abbr>-Fensters</a>;<br><span class="obacht">ab Version&nbsp;17</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">ab</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Abschnitte des <i>Kurz gefasst</i></td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ct</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Textblöcke des Abschnitts</td>
            </tr>
            <tr class="ztj-ebene4">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>auch <code class="quelltext">""</code></td>
              <td>ID des Textblocks;<br>nur wenn <code class="quelltext">it === "Textblock"</code></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">it</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">Blockzitat<br>| Illustration<br>| Liste<br>| Textblock<br>| Überschrift</code></td>
              <td>Typ des Textblocks</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">Punkte<br>| Ziffern</code></td>
              <td>Typ der Liste;<br>nur wenn <code class="quelltext">it === "Liste"</code></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Content des Textblocks im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>auch <code class="quelltext">""</code></td>
              <td>ID des Abschnitts</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">le</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[1-4]/</code></td>
              <td>Level der Einrückung des Abschnitts</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">"Mehr erfahren"<br>| ""</code></td>
              <td>Typ des Abschnitts</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bg</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Bedeutungsgerüste</td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">gn</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Bedeutungsgerüsts (immer identisch mit der des Quellgerüsts)</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">la</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Label;<br><span class="obacht">mit Version&nbsp;19 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">nw</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <abbr title="Extensible Markup Language" lang="en">XML</abbr>-<span class="datentyp">Strings</span> gefüllt</td>
              <td>Nachweise</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">tf</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Textreferenzen</td>
            </tr>
            <tr class="ztj-ebene4">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">li</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID der Lesart</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">ti</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID der Textposition</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Bedeutungsgerüst im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bl</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Belege</td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">da</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Datum des Belegs (für die Anzeige)</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ds</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Datum des Belegs (zum Sortieren)</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Belegs</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Beleg im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">le</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Lemmata</td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">le</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Strings</span> gefüllt</td>
              <td>Schreibungen des Lemmas</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">re</code></p></td>
              <td class="datentyp">String</td>
              <td>auch <code class="quelltext">""</code></td>
              <td>Textreferenz;<br>nur gefüllt wenn <code class="quelltext">ty === "Nebenlemma"</code></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">Hauptlemma<br>| Nebenlemma</code></td>
              <td>Lemmatyp</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Lemma im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">lt</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Literatur</td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID des Literaturtitels</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">si</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Sigle des Literaturtitels</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Literaturtitel im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">md</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Metadaten</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Artikel-ID</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">re</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Revisionen</td>
            </tr>
            <tr class="ztj-ebene4">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">au</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>AutorInnen</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">da</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01"</code></td>
              <td>Datum</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">no</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Änderungsnotiz</td>
            </tr>
            <tr class="ztj-ebene4">
              <td><p><code class="quelltext">xl</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Revision im <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Format</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">tf</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Themenfelder;<br><span class="obacht">ab Version&nbsp;20 <span class="datentyp">Array</span> (davor <span class="datentyp">String</span>)</span></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">Vollartikel<br>| Wortfeldartikel</code></td>
              <td>Artikeltyp</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">tx</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Abschnitte der <i>Wortgeschichte</i></td>
            </tr>
            <tr class="ztj-ebene3">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots sind identisch moduliert wie jene unter <code class="quelltext">data.rd.xl.ab</code>.</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">wi</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Wortinformationen</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p>(ID)</p></td>
              <td class="datentyp">Array</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>ID des Bedeutungsgerüsts</td>
            </tr>
            <tr class="ztj-ebene4">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> im <span class="datentyp">Array</span> sind identisch moduliert wie jene unter <code class="quelltext">data.rd.wi</code>.</p></td>
            </tr>
            <tr>
              <td><p><code class="quelltext">re</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>Revisionsnummer; wird bei jedem Speichern der Kartei um <code class="quelltext">1</code> hochgezählt</td>
            </tr>
            <tr>
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>immer <code class="quelltext">"ztj"</code></td>
              <td>Dateityp; für Tests beim Öffnen einer Kartei, damit nicht beliebige <abbr title="JavaScript Object Notation">JSON</abbr>-Daten in einem anderen Dateiformat geladen werden;<br><span class="obacht">ab Version&nbsp;11, davor immer <code class="quelltext">"wgd"</code></span></td>
            </tr>
            <tr>
              <td><p><code class="quelltext">ve</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>Versionsnummer des <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateiformats</td>
            </tr>
            <tr class="ztj-alt">
              <td><p><code class="quelltext">wo</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Wort, zu dem die Kartei erstellt wurde;<br><span class="obacht">mit Version&nbsp;26 entfernt</span></td>
            </tr>
          </table>

          <!-- ZTB-Format -->
          <h2 id="ztj-ztb"><abbr title="Zettel’s Traum Belege">ZTB</abbr>-Format</h2>

          <p>Für die Kopierfunktionen (<a href="#menueBelege-kopieren" class="link-handbuch"><i>Belege&nbsp;&gt; Kopieren</i></a> und <a href="#menueBelege-einfuegen" class="link-handbuch"><i>Belege&nbsp;&gt; Einfügen</i></a>) gibt es für den Import <abbr title="beziehungsweise">bzw.</abbr> Export von Beleglisten ein eigenes Austauschformat. Der Inhalt dieser <abbr title="Zettel’s Traum Belege">ZTB</abbr>-Dateien ist ebenfalls <abbr title="GNU zip">gzip</abbr>-komprimierter Plain-Text im <abbr title="JavaScript Object Notation">JSON</abbr>-Format. Der Aufbau (<span class="obacht">Datenformat Version&nbsp;3</span>):</p>

          <table class="ztj">
            <tr>
              <th>Schlüssel</th>
              <th>Datentyp</th>
              <th>Format</th>
              <th>Funktion</th>
            </tr>
            <tr>
              <td><p><code class="quelltext">bl</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Belegliste</td>
            </tr>
            <tr class="ztj-ebene1">
              <td colspan="4"><p>In jedem Slot steht ein <span class="datentyp">Object</span>, das fast völlig identisch mit dem einer Karteikarte in <code class="quelltext">data.ka</code> ist, wie man es in gewöhnlichen <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Dateien findet. Dies sind die <strong>Differenzen:</strong></p></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">bd</code></p></td>
              <td class="datentyp">Array</td>
              <td>eindimensional,<br>mit <span class="datentyp">Objects</span> gefüllt</td>
              <td>Bedeutungen</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>Die <span class="datentyp">Objects</span> in den Slots haben die folgenden Schlüssel und Werte:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">bd</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>jeder Slot enthält ein <span class="datentyp">Array</span>, das identisch ist mit <code class="quelltext">data.bd.gr[ID].bd[n].bd</code><br><span class="obacht">ab Version&nbsp;3, davor ein <span class="datentyp">String</span> mit <code class="quelltext">\n</code> und <code class="quelltext">:&nbsp;</code> als Trennzeichen</span></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">gr</code></p></td>
              <td class="datentyp">String</td>
              <td><code class="quelltext">/[0-9]+/</code>,<br>Start mit <code class="quelltext">1</code></td>
              <td>ID des Bedeutungsgerüsts;<br><span class="obacht">identisch mit dem Wert der Originaldatei</span></td>
            </tr>
            <tr class="ztj-ebene2 ztj-alt">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">1 – ∞</code></td>
              <td>ID der Bedeutung;<br><span class="obacht">fehlt</span></td>
            </tr>
            <tr class="ztj-ebene1 ztj-alt">
              <td><p><code class="quelltext">dc</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Karteikarte erstellt wurde;<br><span class="obacht">fehlt</span></td>
            </tr>
            <tr class="ztj-ebene1 ztj-alt">
              <td><p><code class="quelltext">dm</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Karteikarte zuletzt gespeichert wurde;<br><span class="obacht">fehlt</span></td>
            </tr>
            <tr>
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>immer <code class="quelltext">"ztb"</code></td>
              <td>Dateityp; für Tests beim Importieren der Datei, damit nicht beliebige <abbr title="JavaScript Object Notation">JSON</abbr>-Daten in einem anderen Dateiformat geladen werden;<br><span class="obacht">ab Version&nbsp;2, davor immer <code class="quelltext">"bwgd"</code></span></td>
            </tr>
            <tr>
              <td><p><code class="quelltext">ve</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>Versionsnummer des <abbr title="Zettel’s Traum Belege">ZTB</abbr>-Dateiformats</td>
            </tr>
          </table>

          <!-- ZTL-Format -->
          <h2 id="ztj-ztl"><abbr title="Zettel’s Traum Literaturdatenbank">ZTL</abbr>-Format</h2>

          <p>Mithilfe der Funktion <a href="#menueRedaktion-literatur" class="link-handbuch"><i>Redaktion&nbsp;&gt; Literatur</i></a> kann eine Literaturdatenbank angelegt, geladen und bearbeitet werden. Hierfür gibt es ein eigenes Dateiformat. Der Inhalt dieser <abbr title="Zettel’s Traum Literaturdatenbank">ZTL</abbr>-Dateien ist ebenfalls <abbr title="GNU zip">gzip</abbr>-komprimierter Plain-Text im <abbr title="JavaScript Object Notation">JSON</abbr>-Format. Der Aufbau (<span class="obacht">Datenformat Version&nbsp;3</span>):</p>

          <table class="ztj">
            <tr>
              <th>Schlüssel</th>
              <th>Datentyp</th>
              <th>Format</th>
              <th>Funktion</th>
            </tr>
            <tr>
              <td><code class="quelltext">bl</code></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>Blockliste mit gelöschten und darum gesperrten IDs;<br><span class="obacht">mit Version&nbsp;3 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene1">
              <td colspan="4"><p>In jedem Slot <span class="datentyp">Objects</span> mit den folgenden Schlüsseln und Werten:</p></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">da</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01"</code></td>
              <td>Tagesdatum der Löschung</td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>ID der gelöschten Titelaufnahme <abbr title="beziehungsweise">bzw.</abbr> der gelöschten Version einer Titelaufnahme (</td>
            </tr>
            <tr>
              <td><code class="quelltext">dc</code></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Datenbank erstellt wurde</td>
            </tr>
            <tr>
              <td><code class="quelltext">dm</code></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Zeitpunkt, zu dem die Datenbank zuletzt geändert wurde</td>
            </tr>
            <tr>
              <td><p><code class="quelltext">re</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>Revisionsnummer; wird bei jedem Speichern der Datenbank um <code class="quelltext">1</code> hochgezählt</td>
            </tr>
            <tr>
              <td><code class="quelltext">ti</code></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Titelaufnahmen</td>
            </tr>
            <tr class="ztj-ebene1">
              <td colspan="4"><p>Es folgen beliebig viele <span class="datentyp">Objects</span> mit einmaligen Schlüsseln:</p></td>
            </tr>
            <tr class="ztj-ebene1">
              <td><p>(ID)</p></td>
              <td class="datentyp">Array</td>
              <td><code class="quelltext">/[a-z0-9ßäöü-]+/</code></td>
              <td>Titelaufnahme; die neuste Version steht in Slot <code class="quelltext">[0]</code>; <code class="quelltext">/^[0-9]/</code> ist verboten</td>
            </tr>
            <tr class="ztj-ebene2">
              <td colspan="4"><p>In jedem Slot <span class="datentyp">Objects</span> mit den folgenden Schlüsseln und Werten:</p></td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">be</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>BearbeiterIn, die diesen Datensatz erstellt hat</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">da</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2001-11-01<br>T11:22:33.444Z"</code></td>
              <td>Datum, an dem der Datensatz erstellt wurde</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">id</code></p></td>
              <td class="datentyp">String</td>
              <td>10 Hexadezimalziffern</td>
              <td>ID des Datensatzes</td>
            </tr>
            <tr class="ztj-ebene2">
              <td><p><code class="quelltext">td</code></p></td>
              <td class="datentyp">Object</td>
              <td>&nbsp;</td>
              <td>Titeldaten</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ad</code></p></td>
              <td class="datentyp">String</td>
              <td>ISO 8601-Datum:<br><code class="quelltext">"2019-12-01"</code></td>
              <td>Aufrufdatum der URL</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">fo</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Fundort</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">no</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Notizen</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">pn</code></p></td>
              <td class="datentyp">Array</td>
              <td><code class="quelltext">/[0-9]{8,10}X?/</code></td>
              <td>in jedem Slot eine <abbr title="Pica-Produktionsnummer">PPN</abbr></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">si</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Sigle</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">tg</code></p></td>
              <td class="datentyp">Array</td>
              <td>&nbsp;</td>
              <td>in jedem Slot ein Tag;<br><span class="obacht">mit Version&nbsp;2 ergänzt</span></td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ti</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>Titelaufnahme</td>
            </tr>
            <tr class="ztj-ebene3">
              <td><p><code class="quelltext">ul</code></p></td>
              <td class="datentyp">String</td>
              <td>&nbsp;</td>
              <td>URL</td>
            </tr>
            <tr>
              <td><p><code class="quelltext">ty</code></p></td>
              <td class="datentyp">String</td>
              <td>immer <code class="quelltext">"ztl"</code></td>
              <td>Dateityp; für Tests beim Öffnen einer Datenbank, damit nicht beliebige <abbr title="JavaScript Object Notation">JSON</abbr>-Daten in einem anderen Dateiformat geladen werden</td>
            </tr>
            <tr>
              <td><p><code class="quelltext">ve</code></p></td>
              <td class="datentyp">Number</td>
              <td><code class="quelltext">/[0-9]+/</code></td>
              <td>Versionsnummer des <abbr title="Zettel’s Traum Literaturdatenbank">ZTL</abbr>-Dateiformats</td>
            </tr>
          </table>
        </section>

        <!-- XML-SNIPPETS -->
        <section id="sektion-xml" class="suche aus">
          <!-- Belegschnitt -->
          <h2 id="xml-belegschnitt">Belegschnitt</h2>

          <p>Ein typisches <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Snippet, das mit den entsprechenden <a href="#belegliste-xmlZwischenablage" class="link-handbuch">Kopierfunktionen</a> erstellt wurde, könnte so aussehen:</p>

          <pre class="quelltext xml-pretty-print">&lt;Beleg xml:id="n-n-1859-19"&gt;
  &lt;Belegtext&gt;Eine Wache von zehn Mann ward ausgestellt, der Rest der Mannschaft konnte nun thun, was ihm beliebte. Zelte hatten wir keine; unser &lt;Stichwort&gt;Team&lt;/Stichwort&gt; enthielt nichts als unsere Lebensmittel, Kochgeschirr und Teppiche und Munition. Jeder holte sich seine Teppiche aus dem &lt;Stichwort&gt;Team&lt;/Stichwort&gt;, Köche wurden ausgelesen zum Kaffeekochen für die Kompagnieen, große Feuer gebildet, und um jedes Feuer lagen, standen und saßen Gruppen von Soldaten, eingewickelt in Teppiche von allen Farben.&lt;/Belegtext&gt;
  &lt;Fundstelle&gt;
    &lt;Fundort&gt;GoogleBooks&lt;/Fundort&gt;
    &lt;Datum&gt;1859&lt;/Datum&gt;
    &lt;URL&gt;https://books.google.de/books?id=e2dPAQAAMAAJ&amp;amp;pg=PA305&lt;/URL&gt;
    &lt;Aufrufdatum&gt;30.09.2019&lt;/Datum&gt;
    &lt;unstrukturiert&gt;N.&nbsp;N.: Briefe aus Californien. Von einem Deutschen. In: Hausblätter&nbsp;5 (1859), Bd.&nbsp;4, S.&nbsp;143–149, 301–308, 384–388, hier 305f.&lt;/unstrukturiert&gt;
  &lt;/Fundstelle&gt;
&lt;/Beleg&gt;</pre>

          <p><b>&lt;Beleg&gt;:</b> <i>verpflichtend</i>.</p>

          <div class="eingerueckt">
            <p id="xml-belegschnittId"><b>@xml:id:</b> <i>verpflichtend</i>. Die ID wird aus den <a href="#ztj-ztj">Datenfeldern</a> <code class="quelltext">data.ka[ID].au</code> und <code class="quelltext">data.ka[ID].da</code> abgeleitet. Ist der Nachname des Autors vorangestellt und durch ein Komma vom Vornamen getrennt, wird nur der Nachname genutzt. Findet sich im Datenfeld <i>Autor</i> kein Komma, wird das gesamte Datenfeld ausgewertet. Klammern, Satz- und in <abbr title="Extensible Markup Language" lang="en">XML</abbr> problematische Zeichen (&quot; &apos; &lt; &gt; &amp;) werden ersetzt, Leerzeichen durch <code class="quelltext">-</code> ausgetauscht. Anghängt wird eine vierstellige Jahreszahl, die aus dem Datumsfeld extrahiert wird. Die ID endet mit der ID der Karteikarte, wodurch sie für den Karteikasten in jedem Fall eindeutig wird.</p>

            <p><b>&lt;Belegtext&gt;:</b> <i>verpflichtend</i>. Der mit der <a href="#belegliste-xmlZwischenablage" class="link-handbuch">Kopierfunktion</a> ausgewählte Belegschnitt.</p>

            <div class="eingerueckt">
              <p><b>&lt;Autorenzusatz&gt;:</b> <i>fakultativ</i>. Text, der als Autorenzusatz ausgezeichnet wurde. Dabei handelt es sich um erläuternde Ergänzungen der BearbeiterIn. <abbr title="Vergleiche">Vgl.</abbr> das Handbuch zum <a href="#karteikarte-belegKlammern" class="link-handbuch">System der Klammermarkierungen im Belegtext</a>.</p>

              <p><b>&lt;Hervorhebung&gt;:</b> <i>fakultativ</i>. Markierung rein typographischer Textauszeichnungen.</p>

              <p class="eingerueckt"><b>@Stil:</b> <i>fakultativ</i>. Das Attribut kann eine Liste von Werten enthalten, die <a href="https://www.deutschestextarchiv.de/doku/basisformat/typogrAllg.html">im <abbr title="Deutsches Textarchiv-Basisformat">DTABf</abbr> verwendet</a> werden. Beim <a href="#verschiedenes-tei">Import von in <abbr title="Text Encoding Intiative" lang="en">TEI</abbr> kodierten Texten</a> werden nicht alle Textmerkmale übernommen; grob gesagt nur die Inline-Formate. Diese können jedoch prinzipiell alle im @Stil auftauchen. Welche Formate <i class="app-name"></i> importiert, kann man der Datei <span class="datei">./resources/xml-import-tei.xsl</span> entnehmen. <abbr title="Siehe">S.</abbr> auch <span class="datei">./js/app/importTEI.js</span>.</p>

              <p><b>&lt;Loeschung&gt;:</b> <i>fakultativ</i>. Text, der als Löschung ausgezeichnet wurde. Der Text soll im Endprodukt (Webseite) auf keinen Fall mehr erscheinen. Der Tag kann verwendet werden, wenn in einem Belegschnitt aus datenschutzrechtlichen Gründen Text vor der Publikation entfernt werden soll oder muss. Der getaggte Text soll also durch eine Ellipse ersetzt werden: […].</p>

              <p><b>&lt;Markierung&gt;:</b> <i>fakultativ</i>. Markierung von Wörtern/Phrasen, die nicht das Karteiwort sind. (Wurde ein Wort in den <a href="#menueKartei-formvarianten" class="link-handbuch">Formvarianten</a> mit <i>nur markieren</i> aufgenommen oder wurde es im Beleg <a href="#belegliste-annotierenBeleg" class="link-handbuch">mithilfe der Annotierungsfunktion manuell markiert</a>, wird es beim XML-Export als <code class="quelltext">&lt;Markierung&gt;</code> ausgezeichnet.)</p>

              <p><b>&lt;Stichwort&gt;:</b> <i>verpflichtend</i>. Markierung des Karteiworts, um das es geht.</p>

              <p><b>&lt;Streichung&gt;:</b> <i>fakultativ</i>. Text, der als Streichung ausgezeichnet wurde. Der Text soll durch eine Ellipse ersetzt werden: […]. Er darf aber auch wieder aufgelöst werden.</p>

              <p><b>&lt;Zeilenumbruch&gt;:</b> <i>fakultativ</i>.</p>
            </div>

            <p><b>&lt;Fundstelle&gt;:</b> <i>verpflichtend</i>.</p>

            <div class="eingerueckt">
              <p><b>&lt;Aufrufdatum&gt;:</b> <i>fakultativ</i>; Format: <code class="quelltext">([0-9]{2}\.[0-9]{2}\.)?[0-9]{4}</code>. Das Datum des Zugriffs auf eine Webseite wird aus <code class="quelltext">data.ka[ID].qu</code> ausgelesen. Übernommen wird das erste Datum, das hinter der URL steht. Die regulären Ausdrücke, mit denen gesucht wird, finden sich in <code class="quelltext">xml.datum()</code>.</p>

              <p><b>&lt;Datum&gt;:</b> <i>verpflichtend</i>; Format: <code class="quelltext">([0-9]{2}\.[0-9]{2}\.)?[0-9]{4}(–[0-9]{4})?</code>. Das Datum wird aus <code class="quelltext">data.ka[ID].da</code> extrahiert. <abbr title="Vergleiche">Vgl.</abbr> <code class="quelltext">xml.datum()</code>.</p>

              <p><b>&lt;Fundort&gt;:</b> <i>verpflichtend</i>. Abstrakte Angabe zur Quelle, aus der der Beleg sprudelte. Werte können sein <code class="quelltext">DTA&nbsp;| DWDS&nbsp;| GoogleBooks&nbsp;| IDS&nbsp;| online&nbsp;| Bibliothek</code>.</p>

              <p><b>&lt;unstrukturiert&gt;:</b> <i>verpflichtend</i>. Eine klassisch formatierte Literaturangabe.</p>

              <p><b>&lt;URL&gt;:</b> <i>fakultativ</i>. Webseite, von der der Beleg stammt. Die URL wird aus <code class="quelltext">data.ka[ID].qu</code> extrahiert.</p>
            </div>
          </div>

          <!-- Fundstelle -->
          <h2 id="xml-fundstelle">Fundstelle</h2>

          <p>Ein typisches Fundstellen-Snippet, wie es für den Export von Titelaufnahmen aus der <a href="#menueRedaktion-literaturExportieren" class="link-handbuch">Literaturdatenbank</a> verwendet wird, könnte so aussehen:</p>

          <pre class="quelltext xml-pretty-print">&lt;Fundstelle xml:id="dwb2"&gt;
  &lt;Sigle&gt;²DWB&lt;/Sigle&gt;
  &lt;unstrukturiert&gt;Deutsches Wörterbuch von Jacob Grimm und Wilhelm Grimm. Neubearbeitung. Hrsg. von der Berlin-Brandenburgischen Akademie der Wissenschaften (vormals Deutsche Akademie der Wissenschaften) und der Akademie der Wissenschaften zu Göttingen. Bd.&nbsp;1–9. Stuttgart 1983–2018.&lt;/unstrukturiert&gt;
  &lt;Fundort&gt;Bibliothek&lt;/Fundort&gt;
  &lt;PPN&gt;029986761&lt;/PPN&gt;
&lt;/Fundstelle&gt;</pre>

          <p><b>&lt;Fundstelle&gt;:</b> <i>verpflichtend</i>.</p>

          <div class="eingerueckt">
            <p><b>@xml:id:</b> <i>verpflichtend</i>; Format: <code class="quelltext">/[a-z0-9ßäöü-]+/</code>. Die ID der Titelaufnahme.</p>

            <p><b>&lt;Aufrufdatum&gt;:</b> <i>fakultativ</i>; Format: <code class="quelltext">([0-9]{2}\.[0-9]{2}\.)?[0-9]{4}</code>. Das Datum des Zugriffs auf die angegebene URL. Nur vorhanden, wenn <code class="quelltext">&lt;URL&gt;</code> nicht leer ist.</p>

            <p><b>&lt;Fundort&gt;:</b> <i>verpflichtend</i>. Abstrakte Angabe zur Quelle des Literaturtitels. Werte können sein <code class="quelltext">DTA&nbsp;| DWDS&nbsp;| GoogleBooks&nbsp;| IDS&nbsp;| online&nbsp;| Bibliothek</code>.</p>

            <p><b>&lt;PPN&gt;:</b> <i>fakultativ, Mehrfachverwendung möglich</i>; Format: <code class="quelltext">/[0-9]{8,10}X?/</code>. Eine Pica-Produktionsnummer des Literaturtitels.</p>

            <p><b>&lt;Sigle&gt;:</b> <i>verpflichtend</i>. Die Sigle des Literaturtitels.</p>

            <p><b>&lt;unstrukturiert&gt;:</b> <i>verpflichtend</i>. Der Literaturtitel.</p>

            <p><b>&lt;URL&gt;:</b> <i>fakultativ</i>. Eine Webadresse.</p>
          </div>

          <!-- Referenz Beleg -->
          <h2 id="xml-referenzBeleg">Referenz eines Belegs</h2>

          <p>Der Referenz-Tag kann genutzt werden, um auf einen in <abbr title="Extensible Markup Language" lang="en">XML</abbr> exportierten Belegschnitt zu verweisen (zur <a href="#xml-belegschnittId">Form der ID</a> <abbr title="siehe oben">s.&nbsp;o.</abbr>). Ein Beispiel:</p>

          <pre class="quelltext xml-pretty-print">&lt;Belegreferenz Ziel="n-n-1859-19"/&gt;</pre>

          <!-- Referenz Literaturtitel -->
          <h2 id="xml-referenzLiteratur">Referenz eines Literaturtitels</h2>

          <p>Der Referenz-Tag kann genutzt werden, um auf eine in <abbr title="Extensible Markup Language" lang="en">XML</abbr> exportierte Titelaufnahme zu verweisen. Ein Beispiel:</p>

          <pre class="quelltext xml-pretty-print">&lt;Literaturreferenz Ziel="dwb2"&gt;&lt;/Literaturreferenz&gt;</pre>
        </section>

        <!-- VERSCHIEDENES -->
        <section id="sektion-verschiedenes" class="suche aus">
          <!-- TEI-Import -->
          <h2 id="verschiedenes-tei"><abbr title="Text Encoding Intiative" lang="en">TEI</abbr>-Import</h2>

          <p>Importiert wird grundsätzlich der gesamte Text der Seite, die sich hinter der eingegebenen URL im Karteikarten-Formular verbirgt – allerdings mit einigen wenigen Ausnahmen. Genaueres kann dem Stylsheet unter <span class="datei">./resources/xml-import-tei.xsl</span> und dem Script <span class="datei">./js/app/importTEI.js</span> entnommen werden.</p>

          <p>Beim Import wird versucht, Inline-Formatierungen wie Kursivierungen, Fettungen oder Sperrungen zu erhalten. Auf einen Absatz bezogene Formatierungen (Zentrierung oder <abbr title="dergleichen">dgl.</abbr>) werden immer ignoriert.</p>

          <p>Die Trennstriche am Ende einer Textzeile (das sind <q>-</q> oder <q>¬</q>) werden zu <q>[¬]</q> normalisiert, sodass sie für die Leseansicht der Belege automatisch ausgeblendet werden können.</p>

          <p>Werden mehrere Seiten importiert, wird jeder Seitenumbruch nach diesem Muster markiert: <code class="quelltext">␣[:35:]␣</code>. Dabei steht hier die <q>35</q> für die Seitenangabe, die aus <code class="quelltext">@n</code> des <code class="quelltext">&lt;pb&gt;</code> ausgelesen wurde. Mit <code class="quelltext">&lt;cb&gt;</code> wird genauso verfahren. Hier fehlt <code class="quelltext">@n</code> <abbr title="in der Regel">i.&nbsp;d.&nbsp;R.</abbr> jedoch das Attribut, sodass nur ein Platzhalter eingefügt werden kann: <code class="quelltext">␣[:?:]␣</code>.</p>

          <!-- Tag-Dateien -->
          <h2 id="verschiedenes-tagDateien">Format Tag-Dateien</h2>

          <p><i class="app-name"></i> kann <a href="#einstellungen-tagDateien" class="link-handbuch">mit Tag-Dateien verknüpft</a> werden, um <a href="#bedeutungsgeruest-tagFenster" class="link-handbuch">Bedeutungen zu taggen</a>. Die Funktion ist so abstrakt programmiert, dass man problemlos die Inhalte selbst erstellter Tag-Dateien importieren kann. Das folgende Beispiel enthält alle verpflichtenden und möglichen Tags:</p>

          <pre class="quelltext xml-pretty-print">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;register&gt;
  &lt;item&gt;
    &lt;id&gt;1&lt;/id&gt;
    &lt;name&gt;amtssprachlich&lt;/name&gt;
    &lt;abbr&gt;amtsspr.&lt;/abbr&gt;
  &lt;/item&gt;
  &lt;item&gt;
    &lt;id&gt;2&lt;/id&gt;
    &lt;name&gt;bildlich&lt;/name&gt;
  &lt;/item&gt;
...
&lt;/register&gt;</pre>

          <p><b>&lt;register&gt;:</b> <i>verpflichtend.</i> Der (im Rahmen der allgemeinen <abbr title="Extensible Markup Language" lang="en">XML</abbr>-Regeln) beliebig wählbare Name des Wurzelelements wird im <abbr title="user interface" lang="en">UI</abbr> des Programms genutzt, um die Tag-Kategorie anzuzeigen. Dabei wird der erste Buchstabe in eine Versalie umgewandelt.</p>

          <p><b>&lt;item&gt;:</b> <i>verpflichtend.</i> Container-Element für einen Tag.</p>

          <p><b>&lt;id&gt;:</b> <i>verpflichtend.</i> Identifier des Tags. Ändert man den <code class="quelltext">&lt;name&gt;</code>-Tag kann die App via <code class="quelltext">&lt;id&gt;</code> erkennen, welcher Tag geändert wurde. In den Bedeutungsgerüstdaten werden ausschließlich Tag-Kategorie (hier <i>register</i>) und Identifier gespeichert. Die Tag-Bezeichnung wird auf diese Weise flexibel anpassbar.</p>

          <p><b>&lt;name&gt;:</b> <i>verpflichtend.</i> Der eigentliche Tag, ausgeschrieben.</p>

          <p><b>&lt;abbr&gt;:</b> <i>fakultativ.</i> Der eigentliche Tag, abgekürzt.</p>

          <!-- Sperrdatei -->
          <h2 id="verschiedenes-sperrdatei">Lockfile</h2>

          <p>Wird mit <i class="app-name"></i> eine <abbr title="Zettel’s Traum JSON">ZTJ</abbr>-Datei geöffnet, wird im Quellordner der Datei automatisch eine Sperrdatei angelegt. Mithilfe dieser Lock-Datei wird das Öffnen der Kartei für andere NutzerInnen temporär unterbunden, sodass ein kollaboratives Arbeiten in einem Netzwerkordner möglich ist, ohne dass sich die NutzerInnen gegenseitig die Arbeit überschreiben. Beim Schließen der Kartei oder der App wird die Sperrdatei automatisch entfernt.</p>

          <p>Das Schreiben, Überprüfen und Löschen dieser Lock-Datei wird in <code class="quelltext">kartei.lock()</code> geregelt. Ist eine solche Sperrdatei vorhanden, wird das Öffnen der zugehörigen Kartei grundsätzlich unterbunden. Es gibt zwei Ausnahmen:</p>

          <ul>
            <li>dieselbe NutzerIn versucht die Kartei vom selben Computer aus zu öffnen,</li>

            <li>die Lock-Datei wurde vor mehr als zwölf Stunden angelegt.</li>
          </ul>

          <p>Der Name der Sperrdatei folgt demselben Format, das <abbr title="zum Beispiel">z.&nbsp;B.</abbr> auch <i>LibreOffice</i> verwendet: <span class="datei">.~lock.[DATEINAME]#</span>.</p>
          <p>Im Inneren der Lock-Datei steht im Plaintext der auf die Millisekunde genaue Zeitpunkt der Anlage der Datei, der Name des sperrenden Rechners und der seiner NutzerIn. Die einzelnen Werte werden durch <code class="quelltext">;;</code> voneinander getrennt. Das Ganze sieht dann in etwa so aus:</p>

          <pre class="quelltext">2019-04-24T17:36:47.681Z;;nico-sein-rechner;;Nico</pre>

          <h2 id="verschiedenes-cli">CLI</h2>

          <p id="verschiedenes-cliZtj"><b>ZTJ-Datei öffnen</b></p>

          <pre>zettelstraum[.exe] [Pfad zur ZTJ-Datei]</pre>

          <p id="verschiedenes-cliLiteraturDB"><b>Export der Literaturdatenbank</b></p>

          <pre>zettelstraum[.exe] --literatur-db-quelle=[Pfad] --literatur-db-ziel=[Pfad] [--literatur-db-format=xml|txt]</pre>

          <p>Wird das Format nicht angegeben, wird die Literaturdatenbank als <abbr title="Extensible Markup Language" lang="en">XML</abbr> exportiert.</p>

          <p>Ist der Zielpfad ein Ordner, wird der Pfad automatisch um den Dateinamen <code class="quelltext">Literaturliste.[xml|txt]</code> ergänzt.</p>

          <p id="verschiedenes-cliKarteiliste"><b>Export der Karteisuche</b></p>

          <pre>zettelstraum[.exe] --karteiliste-quelle=[Pfad] --karteiliste-ziel=[Pfad] [--karteiliste-vorlage=[Indizes]]</pre>

          <p>Der Quellpfad muss ein Ordner sein. Der Zielpfad kann der Name der Zieldatei oder ein bestehender Ordner sein, in dem die Zieldatei abgelegt werden soll. Ist der Zielpfad ein Ordner, wird der Pfad automatisch um den Dateinamen <code class="quelltext">Karteiliste.[html|md]</code> ergänzt.</p>

          <p>Die Angabe der Vorlage ist fakultativ. Wird keine Vorlage angegeben, wird die erste Vorlage für den Export genutzt. Die Indizes, die hier stehen müssen, sind nullbasiert: <code>--karteiliste-vorlage=0</code> zeigt <abbr title="zum Beispiel">z.&nbsp;B.</abbr> auf die erste Vorlage. Es können auch mehrere, kommagetrennte Indizes angegeben werden, <abbr title="zum Beispiel">z.&nbsp;B.</abbr> <code>--karteiliste-vorlage=0,2</code>. In diesem Fall werden zwei Listen exportiert, und zwar mithilfe der ersten und dritten Vorlage.</p>

          <p id="verschiedenes-cliDevTools"><b>Dev-Tools einbinden</b></p>

          <pre>zettelstraum[.exe] --dev</pre>

          <p>Ist die App nicht paketiert, wird das Programmmenü <i>Dev</i>, über das die Dev-Tools aufgerufen werden können, immer erzeugt. Der Schalter dient dazu, die Tools auch in einer paketierten App zur Verfügung zu stellen.</p>
        </section>
      </div>
    </main>
  </body>
</html>
